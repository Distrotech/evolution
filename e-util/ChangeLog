2003-08-14  Ettore Perazzoli  <ettore@ximian.com>

	Add UIDs to ESource* items so we can distinguish renames from
	removals/additions.

	* test-source-list.c: Made --source and --group get UIDs instead
	of names.
	(on_idle_do_stuff): Updated behavior accordingly.
	(dump_list): Print "(No items)" if there are no groups.
	(dump_group): Print the UID of the group.
	(dump_source): Print the UID of the source.

	* e-source-list.c (load_from_gconf): Match with group UIDs instead
	of group names.
	(e_source_list_peek_source_by_uid): New.
	(e_source_list_peek_source_by_name): Removed.
	(e_source_list_peek_group_by_uid): New.
	(e_source_list_peek_group_by_name): Removed.
	(e_source_list_remove_group_by_uid): New.
	(e_source_list_remove_group_by_name): Removed.
	(e_source_list_remove_source_by_uid): New.
	(e_source_list_remove_source_by_name): Removed.

	* e-source-group.c: New member uid in struct ESourceGroupPrivate.
	(impl_finalize): Free it.
	(e_source_group_new): Set the uid member using e_uid_new().
	(e_source_group_peek_source_by_uid): New.
	(e_source_group_peek_source_by_name): Removed.
	(e_source_group_add_source): Check that the UID is unique, instead
	of the name.
	(e_source_group_remove_source_by_uid): New.
	(e_source_group_remove_source_by_name): Removed.
	(e_source_group_update_from_xmldoc): Use the UID to figure out
	which source has changed, instead of the name.
	(e_source_group_uid_from_xmldoc): New.
	(e_source_group_name_from_xmldoc): Removed.
	(e_source_group_new_from_xmldoc): Set the UID in the new group
	from the XML.
	(e_source_group_to_xml): Set a UID property in the XML.

	* e-source.c: New member uid in struct ESourcePrivate.
	(e_source_new): Initialize using e_uid_new().
	(impl_finalize): Free.
	(e_source_peek_uid): New.
	(e_source_new_from_xml_node): Set the UID from the XML node.
	(e_source_name_from_xml_node): Removed.
	(e_source_uid_from_xml_node): New.
	(e_source_dump_to_xml_node): Set the "uid" property on the XML
	node.

	* e-account.c (e_account_gen_uid): Removed.
	(e_account_new): Use e_uid_new() instead of e_account_gen_uid().

	* e-uid.c (e_uid_new): New file, new function.

2003-08-13  Ettore Perazzoli  <ettore@ximian.com>

	Fix up the semantics of "changed" signals on GConf changes.

	* e-source-group.c (e_source_group_update_from_xmldoc): Added new
	member ignore_source_changed in struct _ESourceGroupPrivate.
	(e_source_group_update_from_xmldoc): Increment
	ignore_source_changed before calling
	e_source_update_from_xml_node(), decrement afterwards.
	(source_changed_callback): Only emit "changed" if
	ignore_source_changed is zero.
	(e_source_group_update_from_xmldoc): Properly emit the "changed"
	signal when the base_uri or the name change.

	* e-source-list.c: Changed type of sync_idle_id from gboolean (!)
	to int and added new member ignore_group_changed in struct
	_ESourceListPrivate.
	(load_from_gconf): Increment ignore_group_changed before calling
	e_source_group_update_from_xmldoc() and decrement it afterwards.
	(group_changed_callback): Only emit the signal if
	ignore_group_changed is zero.

	* e-source.c (e_source_update_from_xml_node): Removed arg
	emit_signals.  Always emit signals.

	* e-source-group.c (e_source_group_update_from_xmldoc): Removed
	arg emit_signals.  Always emit signals.
	(e_source_group_update_from_xml): Likewise.

2003-08-11  Ettore Perazzoli  <ettore@ximian.com>

	* e-source.c (e_source_set_group): Weak_unref the current group if
	not NULL and properly handle the case where a NULL group is being
	passed in.

2003-08-11  Ettore Perazzoli  <ettore@ximian.com>

	* e-source-group.c: New file.
	* e-source-group.h: New file.
	* e-source-list.h: New file.
	* e-source-list.c: New file.
	* e-source.c: New file.
	* e-source.h: New file.
	* test-source-list.c: New file to test the above.

2003-08-05  Dan Winship  <danw@ximian.com>

	* e-html-utils.c (special_chars): add a flag for non-url chars
	(controls, whitespace, ", and |)
	(url_extract): Use that. When urlifying just a hostname, make sure
	it really is a hostname, and not just something like "www.c".
	(e_text_to_html_full): Deal with url_extract returning NULL in the
	"www." case
	(main): add a regression test, #ifdef E_HTML_UTILS_TEST

2003-07-24  Rodrigo Moya <rodrigo@ximian.com>

	* e-config-listener.c (add_key): just preload one level of GConf keys,
	since preloading all makes the calendar startup slow.

2003-07-23  Dan Winship  <danw@ximian.com>

	* Makefile.am: Use EVO_MARSHAL_RULE

	* e-component-listener.c (connection_listen_cb): Fix a non-ANSI
	switch label.

	* e-gui-utils.c: only include "art/empty.xpm" if
	HAVE_LIBGNOMEUI_GNOME_ICON_LOOKUP_H isn't defined

	* e-xml-hash-utils.c (e_xml_to_hash): Deconstify a non-const
	variable to fix a warning.

2003-07-03  JP Rosevear  <jpr@ximian.com>
 
 	* e-xml-hash-utils.c (foreach_save_func): encode the text
 	(e_xml_from_hash): pass xmlDoc to foreach method
 	(e_xmlhash_new): check for file existence
 	(e_xmlhash_destroy): only destroy the hash if it exists
	
2003-07-01  Dan Winship  <danw@ximian.com>

	* e-gui-utils.c (e_icon_for_mime_type): New function to return an
	icon for a MIME type, using GnomeIconTheme if available or
	gnome-vfs and gnome-mime-data if not.

2003-06-19  Dan Winship  <danw@ximian.com>

	* e-xml-hash-utils.c (e_xml_to_hash): don't leak an extra copy of
	the values

2003-06-14  Larry Ewing  <lewing@ximian.com>

	* e-name-western.c (e_name_western_get_suffix_at_str_end): free
	word before breaking out of the loop.

2003-06-12  Rodrigo Moya <rodrigo@ximian.com>

	* e-config-listener.c (add_key): use GCONF_CLIENT_PRELOAD_RECURSIVE
	when adding watched directories to avoid GConfd round-trips.

2003-06-12  Jeffrey Stedfast  <fejj@ximian.com>

	* e-trie.c (e_trie_free): Free the fail_states array.

2003-05-30  Jeffrey Stedfast  <fejj@ximian.com>

	* e-meta.c (meta_load): Stat the file to make sure it exists
	before trying to parse it using xmlParseFile().

