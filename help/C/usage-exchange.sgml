 <chapter id="usage-exchange">
    <title>The Ximian Connector for Microsoft Exchange</title>
    <para>
    The Ximian Connector for Microsoft Exchange allows Ximian
    Evolution clients to access accounts on Microsoft Exchange 2000
    servers. It is available through Ximian Red Carpet in its own
    channel, but cannot be used without a license file.  The license
    file may be purchased from the Ximian online store at <ulink
    url="http://store.ximian.com">store.ximian.com</ulink>. Unlike the
    regular Ximian Evolution client, the Ximian Connector for
    Microsoft Exchange is proprietary software and source code is not
    available.
    </para>
   
  <warning id="licensing">
    <title>Requirements</title>
    <para>
      Ximian Connector works only with Exchange 2000, and requires
      that Outlook Web Access be enabled. Each user will need a
      valid Microsoft Exchange 2000 server account, including license.
  </para>
  </warning>

<sect1 id="new-in-connector-one-two">
<title>What's New in Connector 1.2</title>
  <para>
    Ximian Connector 1.2 has added some of the most frequently
    requested features of Microsoft Exchange clients, including Public
    Folder access and calendar delegation.
  </para>

   <variablelist>     
   <varlistentry>
	<term>Preferences Dialogs</term>
	<listitem>
	  <para>
           The preferences dialogs have been completely overhauled for
           Evolution and Connector 1.2. Select
           <menuchoice><guimenu>Tools</guimenu><guimenuitem>Preferences</guimenuitem></menuchoice>
           from the main Evolution window to change your settings.
          </para>
	</listitem>
      </varlistentry>

      <varlistentry>
	<term>Public Folders, Posting, and Delegation</term>
	<listitem>
	  <para>
            Public folders, posting to folders, and delegation
            functions have been added. You may now set permissions on
            folders to which you have appropriate access, and view the
            folders of other users who have granted you permission to
            view them.
          </para>
	</listitem>
      </varlistentry>

      <varlistentry>
	<term>Flag for Followup</term>
	<listitem>
	  <para>
            Flag for Followup now works properly in both Outlook and
            Evolution, even when set in one and read in the other.
          </para>
	</listitem>
      </varlistentry>

      <varlistentry>
	<term>Improved vFolder Support</term>
	<listitem>
	  <para>
            vFolders now function better with Exchange accounts.
          </para>
	</listitem>
      </varlistentry>


      <varlistentry>
	<term>Notes</term>
	<listitem>
	  <para>
            The "Notes" and "Journal" folders in Exchange accounts are now readable, and you can drag items into them from other folders. Creating new Notes or Journal entries is not yet supported.
          </para>
	</listitem>
      </varlistentry>

      <varlistentry>
	<term>Direct Booking</term>
	<listitem>
	  <para>
            When creating a meeting request, resources such as rooms
            and equipment can be checked and reserved without waiting
            for a reply.	    
          </para>
	</listitem>
      </varlistentry>
    </variablelist>
</sect1>

  <sect1 id="features">
    <title>Connector Features</title>
    <para>
      In addition to the features listed above, <application>Ximian
      Connector</application> supports the following basic 
      <application>Microsoft Exchange</application> features:
      <itemizedlist>
	<listitem>
	  <para>
	    General
	  </para>
	  <variablelist>
	    <varlistentry>
	      <term>Remote <application>Exchange</application> Information Store</term>
	      <listitem>
		<para>
		  Allows you to access mail, address book (including
		  Global Address List folder), and calendars, and task
		  folders on an <application>Exchange
		  2000</application> server from
		  <application>Evolution</application>.
		</para>
	      </listitem>
	    </varlistentry>

	    <varlistentry>
	      <term>Palm synchronization</term>
	      <listitem>
		<para>
		  Supported for Contacts and Calendars on Exchange.
		</para>
	      </listitem>
	    </varlistentry>
	  </variablelist>
	</listitem>
	<listitem>
	  <para>
	    Mail
	  </para>
	  <variablelist>
	    <varlistentry>
	      <term>Viewing Mail in <application>Exchange</application>Folder</term>
	      <listitem>
		<para></para>
	      </listitem>
	    </varlistentry>
	    <varlistentry>
	      <term>Sending Email via Exchange Protocols</term>
	      <listitem>
		<para>
		  You may use the Microsoft Exchange mail transport
		  protocol to send email. Make sure that the address
		  you have entered as your email address is exactly
		  the one that the Exchange server has on file. This
		  may be "yourname@exchange-server.ximian.com" rather
		  than "yourname@ximian.com.a"
		</para>
	      </listitem>
	    </varlistentry>
	  </variablelist>
	</listitem>
	<listitem>
	  <para>
	    Calendar
	  </para>
	  <variablelist>
	    <varlistentry>
	      <term>Meeting Request/Proposal</term>
	      <listitem>
		<para>
		  Allows <application>Evolution</application> users to
		  schedule meetings and view attendee availability for
		  other users (<application>Evolution</application> or
		  <application>Outlook</application> users) on
		  <application>Exchange</application>.
		</para>
	      </listitem>
	    </varlistentry>
	    <varlistentry>
	      <term>Adding iCalendar Meeting Requests to Calendar</term>
	      <listitem>
		<para>
		  If you receive an iCalendar meeting request and add it
		  to your calendar, it will be saved to your
		  <application>Exchange</application> calendar.
		</para>
	      </listitem>
	    </varlistentry>
	  </variablelist>
	</listitem>
	<listitem>
	  <para>
	    Contacts
	  </para>
	  <variablelist>
	    <varlistentry>
	      <term>Address Completion</term>
	      <listitem>
		<para>
		  Supported for your <application>Exchange</application>
		  Contacts folder.  Not yet supported for the Global
		  Address List.
		</para>
	      </listitem>
	    </varlistentry>
	    <varlistentry>
	      <term>Adding vCards to Address Book</term>
	      <listitem>
		<para>
		  If you receive a vCard attachment and click
		  <guibutton>Save in Address Book</guibutton>, it will
		  be saved to your <application>Exchange</application>address book.
		</para>
	      </listitem>
	    </varlistentry>
	    <varlistentry>
	      <term>New Address Book entries can be created on
		<application>Exchange</application> from received email
		messages with a single click</term>
	      <listitem>
		<para>
		</para>
	      </listitem>
	    </varlistentry>
	  </variablelist>
	</listitem>
</itemizedlist>
</para>

<para>
There are, however, some features which are not available:
<itemizedlist>
	    <listitem>
	      <para>
		Work Offline (disconnected mode).
	      </para>
	    </listitem>
	    <listitem>
	      <para>
               "Recall Message" function.
	      </para>
	    </listitem>
	    <listitem>
	      <para>
               Creation of an automatic "out-of-office" reply
               messages.
	      </para>
	    </listitem>
      </itemizedlist>
    </para>
  </sect1>
  <sect1 id="install">
    <title>Installing the Connector</title>
    <para>
       To install the Ximian Connector, run Ximian Red Carpet by
       selecting <menuchoice><guimenu>System</guimenu><guimenuitem>Get
       Software</guimenuitem></menuchoice>.  Subscribe to the Ximian
       Connector for Microsoft Exchange channel, select the Ximian
       Connector for Microsoft
       <application>Exchange</application>2000, and click the
       <guibutton>Install</guibutton> button.  You can also install
       the Connector by downloading the individual packages from
       ftp.ximian.com if you wish.
   </para>
   <para>
       Once you have installed the software, you will also need to
       install a license file.  The license file is the verification
       that you have paid for a license to use the Ximian
       Connector. You can get the license file from the the Ximian
       online store at <ulink
       url="http://store.ximian.com">store.ximian.com</ulink>.  You
       will need a browser with strong (128-bit or greater) encryption
       to access the store. When you purchase a Ximian Connector
       license, the store will mail you the license file with
       instructions for installation. Once installed, the license file
       unlocks the Ximian Connector functionality and you may connect
       to an <application>Exchange</application>server.
    </para>
 </sect1>

  <sect1 id="configure">
    <title>Configuration</title>
    <para>
      Once you have installed the Connector, you need to set up access
      for your <application>Exchange</application>account on both the
      <application>Exchange</application>server and within Evolution.
    </para>

       <sect2 id="config-server">
       <title>Exchange Server Configuration</title>
        <para>
	  Check with your system administrator to ensure that:
	<itemizedlist>
	  <listitem>
	    <para> 
	      You have a valid account on the <application>Exchange</application>server.
	    </para>
	  </listitem>
	  <listitem>
	    <para> You are permitted to access the account with
	      WebDAV. This is the default setting for the
	      <application>Exchange</application>server, so unless
	      your system administrator has specifically turned it
	      off, no changes should be necessary.
	    </para>
	  </listitem>
	</itemizedlist>
      </para>
      <para>
	The Ximian website knowledge base, at <ulink type="http"
	url="http://support.ximian.com">support.ximian.com</ulink>,
	has additional information about checking to make sure that
	your <application>Exchange</application>server will accept
	connections from Ximian Evolution.
      </para>
    </sect2>
    
    <sect2 id="config-client">
      <title>Evolution Settings for Connecting to an <application>Exchange</application>Server</title>
      <para>
	
	Once you know that your server is ready for you to connect, start
	Ximian Evolution and select
	<menuchoice>
	  <guimenu>Tools</guimenu>
	  <guimenuitem>Mail Settings</guimenuitem>
	</menuchoice>
	from any mail view. 
     </para>
      <sect3 id="config-exchange-new-account">
	<title>Creating a New Exchange Account</title>
	

	<para>
	  If you would like to create a new account for your Exchange
	  server, click the <guibutton>Add</guibutton> button in the
	  accounts list. The account creation assistant will guide you
	  through the process, which is also described in <xref
	  linkend="usage-mainwindow-starting">. If you're not sure
	  about any of the information you need, just ask your system
	  administrator.
        </para>
	<variablelist>
	  <varlistentry>
	    <term>Identity</term>
	  <listitem>
	      <para>Enter your name and email address. If you wish,
	      you may add your organization and the location of your
	      signature file. Only your name and email address are
	      required.
	      </para>
	    </listitem>
	  </varlistentry>

	  <varlistentry>
	    <term>Receiving Mail</term>
	  <listitem>
	      <para>
                In this step, you'll enter information about the way
                you check mail:
                 <orderedlist>
		  <listitem>
		    <para>
                      First, select <guilabel>Microsoft
                      Exchange</guilabel> as your server type.
                   </para>
		  </listitem>
		  <listitem>
		    <para>
                     Enter the name of your Exchange email server, and
                     the user name you would use to log in to a
                     Windows workstation in your organization.
                   </para>
		  </listitem>
		    <listitem>
		    <para>
                      If you wish, select the box labelled
                      <guilabel>Use secure connection
                      (SSL)</guilabel>, to take advantage of a more
                      secure connection method. This may allow you to
                      connect to the server from outside your
                      firewall.
                   </para>
		  </listitem>
		  <listitem>
		    <para>
                       If you would like
                       <application>Evolution</application> to
                       remember your password, check the box labelled
                       <guilabel>Remember this password</guilabel>.
                     </para>
		  </listitem>
		</orderedlist>
              </para>
	    </listitem>
	  </varlistentry>

	  <varlistentry>
	    <term>Receiving Mail, Step Two</term>
	  <listitem>
	      <para>There are a few additional options in this step:
               <orderedlist>
		  <listitem>
		    <para>
                       Checking for New Mail: If you would like to
                       check for new mail automatically, click the
                       checkbox and enter an interval in minutes.
                     </para>
		  </listitem>
		  <listitem>
		    <para>
                      Exchange Server: If your Exchange mailbox name
                      is different from your Windows name, enter your
                      mailbox name here.
                     </para>
		  </listitem>
	          <listitem>
		    <para>
                      Override Outlook Web Access Path: In most cases,
                      the URL for web access is
                      "http://server.company.com/exchange." If your
                      system has a path that is not "exchange," check
                      the box and enter the custom path here.
                     </para>
		  </listitem>

		  <listitem>
		    <para>
                     Active Directory: If you would like to use the
    			   Global Address List (GAL), check the box
    			   labelled <guilabel>Create a Global Address
    			   List folder</guilabel> and enter the name
    			   of the directory server.  To avoid strain
    			   on the server, the maximum number of
    			   responses to any Active Directory query has
    			   been set to 500. If you would like to
    			   change that, you may do so here as well.
                     </para>
		  </listitem>
		</orderedlist>
              </para>
	    </listitem>
	  </varlistentry>

	  <varlistentry>
	    <term>Sending Mail</term>
	  <listitem>
	      <para>Select <guilabel>Microsoft Exchange</guilabel> as
	      your email sending method. There is nothing else to do
	      in this step.</para>
	    </listitem>
	  </varlistentry>

	  <varlistentry>
	    <term>Account Management</term>
	  <listitem>
	      <para>Enter a name that you will use to remember this
	      account.  "Exchange Account" is a good suggestion. Note
	      that you cannot have two accounts with the same name.
	      If you'd like to make this your default account for
	      sending email, check the <guilabel>Make this my default
	      account</guilabel> box.</para>
	    </listitem>
	  </varlistentry>
	</variablelist>
	<para>
          You're done.  Click <guibutton>Finish</guibutton> and
          <guibutton>OK</guibutton>, then quit
          <application>Evolution</application> and start it again. Now
          you're ready to get to work on the Exchange server.
        </para>

	<figure>
        <title>Creating an Exchange Account, Step One: Identity</title>
	<screenshot>
	  <screeninfo>Creating an Exchange Account, Step One: Identity</screeninfo>
	  <mediaobject><imageobject>
	      <imagedata  format="png" fileref="figures/exchange-identity" srccredit="Aaron Weber">
	    </imageobject></mediaobject>
	</screenshot>
      </figure>

	<figure>
        <title>Creating an Exchange Account, Step Two: Receiving Mail</title>
	<screenshot>
	  <screeninfo>Creating an Exchange Account, Step Two: Receiving Mail</screeninfo>
	  <mediaobject><imageobject>
	      <imagedata  format="png" fileref="figures/exchange-receive" srccredit="Aaron Weber">
	    </imageobject></mediaobject>
	</screenshot>
      </figure>

	<figure>
        <title>Creating an Exchange Account, Step Three: Mail Options</title>
	<screenshot>
	  <screeninfo>Creating an Exchange Account, Step Three: Mail Options</screeninfo>
	  <mediaobject><imageobject>
	      <imagedata  format="png" fileref="figures/exchange-receive-options" srccredit="Aaron Weber">
	    </imageobject></mediaobject>
	</screenshot>
      </figure>


      </sect3>

      <sect3 id="config-exchange-existing-account">
	<title>Changing an Existing Account to Work with Exchange</title>
	  <para>
	    If you have an existing email account, and want to convert it
	    to use for Exchange, select the account you want to convert
	    and click the <guibutton>Edit</guibutton> button. You'll want
	    to change settings in the following tabs of the account
	    dialog:
	  </para>
	  <variablelist>
	    <varlistentry>
	      <term>Identity</term>
	      <listitem>
	      <para>
		 If your email address will change because you are moving
		 to a new server, then change it in this tab. Otherwise,
		 move to the next tab.
	      </para>
	      </listitem>
	    </varlistentry>
	    <varlistentry>
	      <term>Receiving Mail</term>
	      <listitem>
		<para>
		  Select <guilabel>Microsoft Exchange</guilabel> as your
		  server type. Enter your name of your server next to
		  <guilabel>Host</guilabel>, and the user name for your
		  account next to <guilabel>Username</guilabel>. If your
		  server supports SSL (Secure Socket Layer) encryption, it
		  you can check the <guilabel>Use SSL</guilabel> box to
		  take advantage of more secure data transfers.
		</para>
	      </listitem>
	    </varlistentry>
	    <varlistentry>
	      <term>Receiving Options</term>
	      <listitem>
		  <para>
		    Here, tab, you'll find some additional settings:
		    <variablelist>
		     <varlistentry>
		      <term>Checking for New Mail</term>
		       <listitem>
			 <para>
			    Select whether you would like to check for
			    mail automatically, and if so, how often.
			 </para>
		       </listitem>
		    </varlistentry>
		    <varlistentry>
		      <term>Mailbox Name and Web Access Path</term>
		       <listitem>
			 <para>
			   If your Exchange server requires you to use a
			   different mailbox name from the name you use to
			   log in, select the second check-box and enter
			   the mailbox name.  Check with your system
			   administrator to be sure.
			 </para>
	                 <para>
			   In most cases, the URL for web access is
			  "http://server.company.com/exchange." If your
			  system has a path that is not "exchange," check
			  the box and enter the custom path here.
			 </para>
		       </listitem>
		    </varlistentry>
		    <varlistentry>
		      <term>Active Directory</term>
		       <listitem>
			 <para>
			   If you would like to use the Global Address
			   List (GAL) maintained on your Exchange server,
			   click the tab labelled <guilabel>Receiving
			   Options</guilabel> and check the box labelled
			   <guilabel>Create a Global Address List
			   folder</guilabel>.  The GAL is maintained by
			   your system administrator and you cannot add,
			   change, or remove items from it using Ximian
			   Evolution. However, you can use it to invite
			   people to meetings and to look up addresses and
			   other information. In many organizations, the
			   GAL is stored on a different server from email.
			   If this is the case, you should also specify
			   the directory server name here.
			 </para>
		       </listitem>
		    </varlistentry>
		  </variablelist>
		</para>
	      </listitem>
	    </varlistentry>
	    <varlistentry>
	      <term>Sending Mail</term>
	      <listitem>
		<para>
		  If you will use your Exchange server to send as well as
		  receive mail, select <guilabel>Microsoft
		  Exchange</guilabel> as your server type, and enter the
		  server name as the <guilabel>Host</guilabel>. 
		</para>
	      </listitem>
	    </varlistentry>
	  </variablelist>
	<para>

        Once you have made those changes, click the
        <guibutton>OK</guibutton> button.
      </para>
	<para>
          Then, quit <application>Evolution</application> and start it
          up again. Changes to the Ximian Connector accounts
          configuration are not active until you have restarted the
          application.
       </para>
      </sect3>      
    </sect2>
  </sect1>
  
  <sect1 id="access">
    <title>Accessing the <application>Exchange</application>Server</title>
    <para>
      Like IMAP and LDAP data, information for
      <application>Exchange</application>accounts is stored on the
      server, not on your desktop computer.  This means that you can
      access it from multiple locations. It also means that your
      Microsoft <application>Exchange</application>account information
      is in a seperate folder tree from the <guilabel>Local</guilabel>
      tree in your folder bar. You'll see it below the local tree,
      with the name you gave the account. If you have multiple
      accounts, you will have multiple folder trees.
    </para>
    <para>
      Click on any of the folder tree items to visit them; you may
      have to enter your server password.  You can now create contact
      cards, send and receive email as you would normally. If there
      are items in your local calendar or addressbook that you'd like
      to add to your <application>Exchange</application>stores, you
      can copy and paste them over, or just drag items from one folder
      to another as you would with two local stores.
    </para>

      <note id="save-to-local-or-exchange">
	<title>Saving Attached Addresses and Appointments</title>
	<para>
          If you are using both an Exchange account and a local mail
          account, you should be aware that whenever you save an email
          address or appointment from an email message, it will be
          saved in your Exchange contacts list or calendar, rather
          than in your local account. The same is true of
          synchronization with Palm-OS devices: tasks, appointments,
          and addresses from your Palm-OS device will be synchronized
          with those in the Exchange folders rather than local
          folders.
       </para>
      </note>

   <tip id="gal-empty">
	<title>The Global Address List Is Empty At First</title>
	<para>
          To avoid unnecessary strain on the server, the GAL will
          appear empty until you have searched for something in it.
          If you want to display all the cards in the list, click in
          the search box and press <keycap>Enter</keycap>.  This
          enters a blank search: since every card contains a blank in
          it, every card will appear.
        </para>
      </tip>
    </sect1>
    <sect1 id="full-advantage">
      <title>Taking Full Advantage of the Exchange Server When Scheduling Appointments</title>
      <para>
        When you schedule a meeting with your calendar on the
        <application>Exchange</application>server, you can check when
        other local Exchange users are busy according to their
        <application>Exchange</application>calendars. To do so:
     </para>
      <figure>
        <title>Scheduling With Free/Busy Information</title>
	<screenshot>
	  <screeninfo>Using the Free/Busy Feature</screeninfo>
	  <mediaobject><imageobject>
	      <imagedata  format="png" fileref="figures/schedule" srccredit="Aaron Weber">
	    </imageobject></mediaobject>
	</screenshot>
      </figure>

       <note id="reminders-in-exchange">
         <title>Reminders In Exchange</title>
         <para>
          Reminders for appointments in your Exchange calendar will
          not work until you have run Evolution at least once after
          logging in. This is different from locally stored reminders,
          which will work from the moment you log in, regardless of
          whether you have run Evolution in the session.
         </para>
        </note>
      <orderedlist numeration="arabic">
	<listitem>
	  <para>
            Open a new appointment in the calendar.
          </para>
	</listitem>
	<listitem>
	  <para> Choose <menuchoice> <guimenu>Actions</guimenu>
	      <guimenuitem>Schedule Meeting</guimenuitem>
	      </menuchoice> in the meeting editor window.
          </para>
	</listitem>
	<listitem>
	  <para> Add attendees, either by entering their email
            addresses into the list, or by clicking the
            <guibutton>Invite Others</guibutton> button. If you choose
            to so, it's best to use the Global Address List (GAL).
            Choose the GAL from the drop-down list of address sources
            at the top of the dialog box.
         </para>
	</listitem>
	<listitem>
	  <para>
          Choose <guilabel>Options</guilabel> and then
          <guilabel>Update Free/Busy</guilabel> to check participant
          schedules and, if possible, update the meeting in all
          participants' calendars.
         </para>
 	</listitem>
      </orderedlist>
      <tip id="autopick">
	<title>Using Autopick to Adjust Meeting Times</title>
	<para>
         If meeting attendees are not available during the times you
         have scheduled a meeting, you can "nudge" the meeting forward
         or backward to the nearest available time.  To do so, just
         click the arrows to the left or right of the
         <guilabel>Autopick</guilabel> button. The autopick tool will
         move the meeting to the nearest time during which all
         attendees are available.  If you aren't satisfied with those
         results, you can drag the edges of the meeting time to the
         hours that you want to select.
      </para>
      </tip>
    </sect1>
</chapter>

