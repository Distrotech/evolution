2000-07-25  Ettore Perazzoli  <ettore@helixcode.com>

	* mail-config.c (create_service_page): Call
	`gtk_option_menu_set_menu()' as the last thing, as `GtkOptionMenu'
	is fscking broken.  Also, `gtk_widget_show()' the individual menu
	items.

2000-07-24  Dan Winship  <danw@helixcode.com>

	* message-list.c (mark_msg_seen, ml_tree_set_value_at,
	message_list_regenerate): Update for CamelFolder API changes.
	(Certain functions no longer take a CamelException.)

	* mail-ops.c (real_fetch_mail, real_send_mail, real_delete_msg):
	ditto

	* component-factory.c (real_create_imap_storage,
	real_create_news_storage): ditto

2000-07-24  Dan Winship  <danw@helixcode.com>

	* component-factory.c, folder-browser-factory.c, test-mail.c:
	Remove GOAD support.

	* main.c: Remove GOAD support.
	(main): More "guess the build mistake" fun, this time for the
	failure to initialize Bonobo case.

2000-07-23  Ettore Perazzoli  <ettore@helixcode.com>

	* mail-ops.c (create_message_composer): New.
	(compose_msg): Use it.
	(send_to_url): Likewise.
	(forward_msg): Likewise.

	* folder-browser-factory.c (control_activate): Use `_()' instead
	of `N_()'.

2000-07-20  Ettore Perazzoli  <ettore@helixcode.com>

	* component-factory.c (factory_fn): Updated for the new
	`evolution_shell_component_new()' arg.

2000-07-19  Jeffrey Stedfast  <fejj@helixcode.com>

	* message-thread.c (thread_messages): What if message info is NULL?

2000-07-16  Jeffrey Stedfast <fejj@helixcode.com>

	* folder-browser.c, component-factory.c: Initial code to support
	IMAP folders that don't use "/" as a directory separator.

2000-07-15  Ettore Perazzoli  <ettore@helixcode.com>

	* mail-ops.c (set_x_mailer_header): New helper function to set the
	`X-Mailer:' header to to `Evolution <version> [Developer
	Preview]".
	(real_send_mail): Call it.

2000-07-14  Ettore Perazzoli  <ettore@helixcode.com>

	* Makefile.am (evolution_mail_LDADD): Add `GCONF_LIBS'.

2000-07-14  Dan Winship  <danw@helixcode.com>

	* mail-format.c (write_headers): put a <p> at the end of the
	header table. (I think there used to be whitespace after it, but
	then some gtkhtml change got rid of it...)
	(handle_text_plain): Don't do this <PRE>. Instead, CONVERT_NL and
	CONVERT_SPACES and wrap it in <TT>. Now if the sender didn't
	include any newlines, it will be wrapped to the width of the
	window instead of extending off into infinity.

2000-07-13  Dan Winship  <danw@helixcode.com>

	* message-list.c (message_list_destroy): Only unref the folder if
	it's been set.

	* folder-browser.c (folder_browser_destroy): Only sync the folder
	if it's been set.

2000-07-13  Jonathan Blandford  <jrb@redhat.com>

	* mail-config.c (create_transport):
	s/CAMEL_SERVICE_NEED_HOST/CAMEL_SERVICE_URL_NEED_HOST.

2000-07-13  Dan Winship  <danw@helixcode.com>

	* mail-config.c (add_row): Add a "gboolean required" argument, and
	set its value on the entry.
	(create_source, create_transport): Create rows for URL elements if
	the URL ALLOWs them. Mark them required if it NEEDs them.
	(service_note_doneness): Only require the required fields to be
	filled in.

	Now the IMAP config page allows the user to enter a path, but
	doesn't require it.
	
2000-07-13  Jeffrey Stedfast  <fejj@helixcode.com>

	* mail-ops.c (real_fetch_mail): Back to the old way to avoid
	g_warnings, yay. Also fix append to send a flags argument (0)

2000-07-12  Chris Toshok  <toshok@helixcode.com>

	* mail-config.c (providers_config_new): fix some cut & paste bung.

2000-07-12  Chris Toshok  <toshok@helixcode.com>
	
	* mail-format.c (setup_function_table): add "message/news" to the
	mime_function_table using the same handler as message/rfc822.

2000-07-12  Chris Toshok  <toshok@helixcode.com>

	* mail-config.glade*: add news server tab to dialog.

	* mail-config.c (on_NewsServerConfigDialogButton_clicked): new function.
	(on_clistNewsServers_select_row): new function.
	(on_cmdNewsServersAdd_clicked): new function.
	(on_cmdNewsServersEdit_clicked): new function.
	(on_cmdNewsServersDelete_clicked): new function.
	(providers_config_new): mirror the source tab's code to fill in
	the news server tab.
	(write_config): save out the news server.
	(create_news_server_config_dialog): new function.
	(create_news_server_page): new function.

2000-07-12  Peter Williams  <peterw@helixcode.com>

	* mail-display.c (save_data): Change from evolution_dir to
	g_get_home_dir() for default location of save file.

2000-07-11  Jeffrey Stedfast  <fejj@helixcode.com>

	* mail-ops.c (real_fetch_mail): Changed to use 
	camel_folder_move_message_to () rather than get_message () and then
	append_message (). This also makes it so we don't have to worry about
	fetching message flags to pass to the new append_message () method.

	* folder-browser.c (folder_browser_load_folder): Disable
	Search capability menu/entry if folder doesn't support it.

	* message-list.c (message_list_regenerate): Don't perform
	a search if the folder doesn't support it.

2000-07-11  Dan Winship  <danw@helixcode.com>

	* mail-ops.c (real_send_mail): Set the post_send_data flag rather
	than toggling it. (Maybe we'll need more control over it later,
	but for now, the only flag we set is "replied", and we want
	that set, not toggled.)

2000-07-10  Dan Winship  <danw@helixcode.com>

	* folder-browser-factory.c (control_activate): Work with both
	current and 0.15 bonobo

	* kill more debugging messages

	* mail-ops.c (real_fetch_mail): Don't multiply free dest_url.

	* message-list.c (message_list_select): Update
	message_list_select_next to do either next or previous.

	* folder-browser.c (etable_key): Make 'n' and 'p' do next and
	previous unread message.

	* mail-ops.c (select_first_unread): Update.
	(real_fetch_mail): clean up a bit.

2000-07-10  Ettore Perazzoli  <ettore@helixcode.com>

	* mail-ops.c (forward_msg): Initialize `fwd_subj' to NULL if
	`from' is NULL.

2000-07-10  Jeffrey Stedfast  <fejj@helixcode.com>

	* mail-ops.c (real_fetch_mail): Fixed broken POP fetching

2000-07-10  Ettore Perazzoli  <ettore@helixcode.com>

	* component-factory.c: Removed variable `browsers'.
	(create_view): Don't update it.
	(owner_unset_cb): Don't sync the folders here anymore, because at
	this point the folder browser is dead already so we cannot get a
	valid list of folders from it anymore.

	* folder-browser.c (folder_browser_destroy): Sync the associated
	mailbox first.

2000-07-10  Christopher James Lahey  <clahey@helixcode.com>

	* message-list.c, message-list.h: Switched from ETable to
	ETableScrolled.

2000-07-10  Jeffrey Stedfast  <fejj@helixcode.com>

	* mail-ops.c (real_fetch_mail): Fixed movemail so that it too would
	deliver to Inbox.

2000-07-09  Dan Winship  <danw@helixcode.com>

	* message-list.c (get_message_info): Don't g_warn if the user
	selects a fake tree parent.
	(message_list_select_next): Ignore fake rows
	(build_tree): Store the "root_subject" for fake rows
	(ml_tree_value_at): Display the correct subject for fake rows.
	(on_cursor_change_cmd): Update for the other changes and set
	cursor_uid to NULL when the cursor is on a fake row.

	* mail-ops.c (reply): Don't try to reply when no (real) message is
	selected.
	(forward_msg): Ditto.

2000-07-09  Christopher James Lahey  <clahey@helixcode.com>

	* message-list.c: Remove setting of dnd_code since that's handled
	internally to ETable.

2000-07-08  Dan Winship  <danw@helixcode.com>

	* folder-browser.c (etable_key): Fix up the pageup/pagedown
	increment a bit.

	* folder-browser-factory.c (control_activate): Add a "Threaded
	Message List" item to the "View" menu.

	* message-list.c (message_list_toggle_threads): Handler for that.
	(build_flat): New function to build a "flat" message list using
	the tree model.
	(message_list_regenerate): Build tree or flat message list
	depending on the global setting.

	* message-thread.c (get_root_subject): fix a "Re:" parsing bug

2000-07-08  Jeffrey Stedfast  <fejj@helixcode.com>

	* mail-ops.c (real_fetch_mail): Always dump incoming messages to
	Inbox (assuming not filtered to another location).

2000-07-08  Ettore Perazzoli  <ettore@helixcode.com>

	* folder-browser-factory.c (control_activate): Move the
	"Expunge" item to the "Action" menu.
	(control_deactivate): Accordingly.

2000-07-08  Dan Winship  <danw@helixcode.com>

	* mail-ops.c (forward_msg): Deal with having multiple selected
	messages.

	* mail-format.c (mail_generate_forward): Removed. (Integrated into
	forward_msg)

2000-07-08  Jeffrey Stedfast  <fejj@helixcode.com>

	* message-list.c (build_tree): Small fix to stop uid data from
	being set on a message-list tree node when it didn't correspond
	to an actual message.

2000-07-08  Dan Winship  <danw@helixcode.com>

	* message-list.c (get_message_info): Fix Jeff's FIXME: This does
	get called with out-of-range data sometimes, so we do need the
	check. Use e_table_model_row_count to get the actual right answer.

2000-07-07  Jeffrey Stedfast  <fejj@helixcode.com>

	* message-list.c (get_message_info): This wasn't quite right, it
	will now work but still isn't perfect. See FIXME comment.

2000-07-07  Dan Winship  <danw@helixcode.com>

	* message-thread.c (remove_node): Add another argument "clast"
	pointing to the container before the current one in the list,
	which it can update if that turns out to be the one that it
	removed.
	(group_root_set): Update for remove_node change, and remove both
	nodes in the "subjects are common" case. Fixes a bug that would
	cause the message list to be truncated if this rule was invoked.

	(sort_node): sort the tree by the original order of the messages
	in the folder rather than by date.

2000-07-07  Dan Winship  <danw@helixcode.com>

	* message-list.c: Lots of changes. Store uids as node data on the
	tree nodes and use those rather than rows where possible. (The
	concept of "row" is just getting too complicated.) Get rid of the
	summary_table, because given a uid we can call
	camel_folder_get_message_info, which makes more sense than keeping
	a separate uid->row hash table ourselves.

	(get_message_info): update
	(get_message_row): removed
	(ml_col_cound, ml_row_count, ml_value_at, ml_set_value_at,
	ml_cell_is_editable, ml_duplicate_value, ml_free_value,
	ml_initialize_value, ml_value_is_empty, ml_value_to_string):
	Removed. We always use the tree model now.
	(message_list_init): Remove the non-tree code.
	(build_tree): store uids in the tree rather than row numbers,
	and build the message_list->uid_rowmap to map from uids to rows
	when needed.
	(message_list_regenerate): Renamed from _set_search, since it's
	used to redraw in non-search cases too.
	(message_changed): Use the uid_rowmap to get a model row number.

	* message-thread.c (thread_messages): Change the interface on this
	to work with the new MessageList.

	* folder-browser.c (search_set, folder_browser_clear_search): 
	s/message_list_set_search/message_list_regenerate/

2000-07-07  Christopher James Lahey  <clahey@helixcode.com>

	* message-list.c (get_message_info): Handle a row number of -1
	properly.

2000-07-06  Dan Winship  <danw@helixcode.com>

	* message-list.c (get_message_info): Map tree model row numbers to
	summary row numbers.
	(ml_tree_value_at, ml_tree_set_value_at,
	ml_tree_is_cell_editable): So don't do that here.

2000-07-06  JP Rosevear  <jpr@arcavia.com>

	* mail-config.glade*: Glade files for the configuration dialog.
	
	* mail-config.c (providers_config_new): Build the dialog with
	glade.

2000-07-06  Dan Winship  <danw@helixcode.com>

	* folder-browser-factory.c, folder-browser.c, mail-ops.c,
	message-list.c: fix warnings.

	* main.c (main): gtkhtmllib_init is no more. Call gconf_init
	directly instead.

	* message-list.c (message_list_select_next): New function to
	select the first message on or after the given row that meets
	certain flag criteria.

	* mail-ops.c (real_fetch_mail): call message_list_select_next to
	select first unread message in current folder if it changes.
	(real_delete_msg): Remove the code to move the etable cursor. It
	only makes sense really if you deleted the message with the
	keyboard, so do it from etable_key.

	* folder-browser.c (etable_key): call message_list_select_next to
	select next non-deleted message after Delete.

	* mail-identify.c: Add a workaround for a small gnome-vfs 0.2 bug
	so we don't need to require CVS gnome-vfs.

2000-07-06  Not Zed  <NotZed@HelixCode.com>

	* message-thread.c (sort_thread): sort messages based on date for
	the initial sort order.
	(thread_messages_free): Implement.

	* message-list.c (message_list_init_header): Setup the subject
	renderer to a tree in tree mode.
	(on_cursor_change_cmd): For a tree model, map the view row to the
	data row.
	(build_tree): Builds the tree data structure of all messages.
	(message_list_set_search): For a tree model, build the tree here.
	(ml_tree_icon_at): Icon callback, returns nothing.
	(ml_tree_value_at):
	(ml_tree_set_value_at): 
	(ml_tree_is_cell_editable): Maps tree node to data row, and calls
	the equivalent table callback
	(message_list_init_renderers): Setup the tree renderer if needed.
	(message_list_init): set the root node invisible afterall.
	(message_list_set_search): Clear the old tree before putting in a
	new one.

	* message-list.h: Add a tree renderer to render list, and
	tree_view indicator.

	* message-thread.[ch]: Code for message threading. 

2000-07-05  Dan Winship  <danw@helixcode.com>

	* mail-identify.c (mail_identify_mime_part): Oops. My gnome-vfs
	was out-of-date. Update for changed function name.

2000-07-05  Dan Winship  <danw@helixcode.com>

	* mail-identify.c (mail_identify_mime_part): Use the gnomevfs
	sniff buffer interface to try to identify the MIME type when
	everything else fails.

	* mail-display.c (on_object_requested):
	* mail-format.c (lookup_handler, handle_undisplayable,
	handle_audio): s/gnome_mime/gnome_vfs_mime/

	* Makefile.am: Add gnomevfs stuff

2000-07-03  Ettore Perazzoli  <ettore@helixcode.com>

	* component-factory.c (create_folder): Get rid of a compiler
	warning by making sure `folder' is always initialized to some
	value for any code path.

2000-07-03  Dan Winship  <danw@helixcode.com>

	* message-list.c (select_msg): call mail_display_set_message with
	NULL if the message we tried to select doesn't exist (probably
	meaning we tried to selecte the first message and the folder is
	empty.)

	* mail-display.c (mail_display_set_message): deal with NULL as an
	input (meaning "undisplay previous message and display nothing").

2000-07-02  Dan Winship  <danw@helixcode.com>

	* mail-ops.c (real_fetch_mail): Remove hack to redisplay the
	inbox, since folder_changed signals will now be emitted
	appropriately.

	* component-factory.c (create_vfolder_storage): Fix
	filter_driver_new invocation.

	* Makefile.am (bin_PROGRAMS): test-mail and test-thread should be
	noinst.

	* mail-ops.c (real_fetch_mail): 
	(vfolder_editor_clicked): 
	* component-factory.c (create_vfolder_storage):
	Pass mail_uri_to_folder and rules to filter_driver_new.

2000-07-02  Ettore Perazzoli  <ettore@helixcode.com>

	* folder-browser.c (mail_uri_to_folder): Fix double freeing of the
	local exception `ex'.

2000-07-01  Ettore Perazzoli  <ettore@helixcode.com>

	* mail-ops.c (refile_msg): Only allow type "mail" in the folder
	selection dialog.

2000-07-01  Dan Winship  <danw@helixcode.com>

	* pixmaps.h, pixmaps/*.xpm: Removed. These aren't being used any
	more. (The real pixmaps are in ../art.)

2000-07-01  Jeffrey Stedfast  <fejj@helixcode.com>

	* message-list.c (get_message_info):
	(select_msg): Updated to reflect camel-folder changes.

	* mail-ops.c (real_fetch_mail): Modified to reflect camel-folder
	changes.

2000-06-30  Dan Winship  <danw@helixcode.com>

	* mail-ops.c (print_msg): Use gnome-print to do a print preview.

	* folder-browser-factory.c: Hook up "Print" button.

	* message-list.c (message_list_foreach): New function, a wrapper
	around e_table_selected_row_foreach, which calls the callback
	function with UIDs rather than row numbers.

	* folder-browser-factory.c: Remove never-used "Find" button from
	the toolbar and replace it with "Refile". (We need a better icon
	for this...). Hook up "Refile" to "refile_msg".

	* mail-ops.c (refile_msg): Call the shell's user_select_folder
	routine, and then use message_list_foreach and real_refile_msg to
	do the work.
	(delete_msg): Update to use message_list_foreach.

	* folder-browser.c (mail_uri_to_folder): new function, extracted
	from folder_browser_load_folder, to turn a URI into a folder.
	(folder_browser_load_folder): Use it.

2000-06-30  Peter Williams  <peterw@curious-george.helixcode.com>

	* component-factory.c (create_news_storage, create_imap_storage):
	Fixed to use new EvolutionShellClient proxy thingamajiggie.

2000-06-30  Dan Winship  <danw@helixcode.com>

	* message-list.c (on_row_selection): use the ETable row_selection
	signal to track how many rows are selected. Eventually we will use
	this info to disable toolbar buttons when you have too few/too
	many messages selected, but the current toolbar widget doesn't
	allow that.

	* message-list.h, message-list.c, mail-ops.c: Change selected_row
	and selected_uid fields of MessageList to cursor_row and
	cursor_uid to be more correct according to the new ETable
	interfaces.

2000-06-30  Ettore Perazzoli  <ettore@helixcode.com>

	* component-factory.c: Eeek.  Fix typo: add missing star in the
	declaration of `global_shell_client'.

2000-06-29  Ettore Perazzoli  <ettore@helixcode.com>

	* component-factory.c: Replace `global_shell_interface' with
	`global_shell_client'.

2000-06-29  Jeffrey Stedfast  <fejj@helixcode.com>

	* mail-ops.c (delete_msg): Clean up compile warnings
	(real_fetch_mail): Fetching from IMAP should do nothing

2000-06-29  Christopher James Lahey  <clahey@helixcode.com>

	* mail-ops.c: Handle multiple deletes (change by Peter Williams.)

2000-06-29  Jeffrey Stedfast  <fejj@helixcode.com>

	* folder-browser-factory.c: Changed "Send" to "Compose" to
	avoid user confusion. Compose is a little more intuitive.
	Also changed the pixmap to MAIL_NEW instead of MAIL_SND

	* mail-ops.c (compose_msg): Renamed to avoid confusion

2000-06-29  Dan Winship  <danw@helixcode.com>

	* component-factory.c (create_imap_storage, create_news_storage):
	remove some code incorrectly copied and pasted from
	create_vfolder_storage which caused vfolder creation to stop
	working.

2000-06-29  Christopher James Lahey  <clahey@helixcode.com>

	* message-list.c, mail-ops.c: Changed the name of
	e_table_select_row to e_table_set_cursor_row.

2000-06-29  Peter Williams  <peterw@helixcode.com>

	* message-list.c (message_list_init): Set the dnd_code of the
	ETableHeader to something so that Solaris sprintf doesn't die
	on a NULL string.

	* mail-config.c (providers_config_new): Check for a null "transport"
	string (not all OS' handle NULL strings well *cough* Solaris)

2000-06-28  Dan Winship  <danw@helixcode.com>

	* mail-format.c (mail_generate_forward): add default subjects

	* component-factory.c (create_folder): Refuse to create folders
	not of type "mail", and correctly create an empty "mbox" folder
	for new folders in /local.

	* main.c (init_corba): Call od_assert_using_oaf() or
	od_assert_using_goad() as appropriate to make sure people didn't
	somehow trick the build system.

2000-06-28  Jeffrey Stedfast  <fejj@helixcode.com>

	* message-list.c: Added prototype for filter_date to make
	it build cleanly

2000-06-27  Christopher James Lahey  <clahey@helixcode.com>

	* message-list.c: Made dates display grouping information
	properly.

2000-06-27  Peter Williams  <peterw@curious-george.helixcode.com>

	* message-list.c (mark_msg_seen): Need to return a value
	on error.

	* main.c (main): Don't start threads or enter threads if
	there's no threading! Sigh.

	* test-thread.c: Don't compile if no threads.

	* session.c: Work without broken threads.

	* message-list.c (filter_date): Solve the ctime_r problem the
	correct way, with the magic of autoconf.

2000-06-27  Christopher James Lahey  <clahey@helixcode.com>

	* message-list.c: Work around mismatched ctime_r functions.  This
	will be fixed.

2000-06-27  Peter Williams  <peterw@curious-george.helixcode.com>

	* mail-threads.c: Don't compile this if we don't have
	threads enabled. This should maybe be on the Makefile.am
	level.

2000-06-27  Michael Zucchi  <zucchi@zedzone.mmc.com.au>

	* component-factory.c (owner_set_cb): Put in a gross hack to
	export the shell reference elsewhere.

2000-06-26  Christopher James Lahey  <clahey@helixcode.com>

	* message-list.c: Added a value_to_string handler.

2000-06-26  Peter Williams  <peterw@helixcode.com>

	* component-factory.c, mail-ops.c: #ifdef the threads stuff so
	that if USE_BROKEN_THREADS is not defined we just call the functions
	in the main thread.

	* mail-threads.h: Don't declare funcs if USE_BROKEN_THREADS not
	defined.

	* mail-threads.c: Put the query and message boxes on top so that
	you can see them.

2000-06-26  Jeffrey Stedfast  <fejj@helixcode.com>

	* mail-config.c (error_dialog): va_start() returns void, don't
	assign it's retval to a variable.

2000-06-26  Ettore Perazzoli  <ettore@helixcode.com>

	* main.c (main): Call `GDK_THREADS_ENTER()' and
	`GDK_THREADS_LEAVE()' around the main loop as in the examples from
	the GTK+ FAQ.

	* mail-threads.c (DEBUG): New macro for debugging.
	(read_msg): Use it.

2000-06-25  Peter Williams  <peterw@helixcode.com>

	* Makefile.am: Clean up the various _LIBS and _CFLAGS
	to work with simpler THREADS_LIBS and THREADS_CFLAGS scheme.

2000-06-23  Jeffrey Stedfast  <fejj@helixcode.com>

	* folder-browser.c (folder_browser_load_folder): Improved the
	code to separate the imap namespace from the folder name.

2000-06-23  Peter Williams  <peterw@curious-george.helixcode.com>

	* component-factory.c: Include e-util/e-setup.h for the
	prototype of evolution_dir; prototype create_news_storage.
	(real_create_imap_storage, real_create_news_storage): New
	functions moving the camel stuff into the async callback.
	(create_imap_storage, create_news_storage): Chopped in
	half to move camel stuff as above.

	* mail-ops.c: Include "mail-threads.h" for threading protos.
	(real_fetch_mail, real_send_mail, real_expunge_folder): 
	New functions moving the camel stuff into the async callback.
	(async_mail_exception_dialog): A version of mail_exception_dialog
	to be called from the async handlers (just calls mail_op_error())
	(fetch_mail, expunge_folder, composer_send_cb): Cut in half to
	move camel stuff as above.
	(cleanup_send_mail): Clean up after the async real_send_mail
	with the gtk_object_destroys et al.

	* mail-threads.c: Instead of hiding the progress bar, make it
	zip back and forth constantly.
	(progress_timeout): New func. Timeout called to make the pbar
	shimmy.
	(timeout_toggle): New func. Turn on and off the shimmy effect.
	(check_cond): New func. Make sure that the GCond for modal
	operation is initialized before mail_op_{error,get_password}.
	(show_error_clicked, read_msg, get_password_clicked): Move
	over to timeout_toggle.
	(mail_op_error,mail_op_get_password): Add check_cond() call.

	* main.c: (main) Call g_thread_init.

	* session.c: Change auth_callback stuff over to assume that it's
	being called async. Note: no real good way to tell if this is
	the case or not.
	(request_callback): ifdef'ed out
	(evolution_auth_callback): Use mail_op_get_password.
	
2000-06-22  Jeffrey Stedfast  <fejj@helixcode.com>

	* folder-browser.c (folder_browser_load_folder): Now should
	correctly get the selected folder from the given URL.

2000-06-22  Chris Toshok  <toshok@helixcode.com>

	* folder-browser.c (folder_browser_load_folder): add handling for
	loading "news:" folders.

	* component-factory.c (create_news_storage): add a root for news
	source.
	(owner_set_cb): call create_news_storage.

2000-06-22  Jeffrey Stedfast  <fejj@helixcode.com>

	* folder-browser.c (folder_browser_load_folder): Updated to
	prepend url-> path if it exists for that imap store.

	* component-factory.c (create_imap_storage): Modified to not
	prepend a hard-coded namespace.

2000-06-22  Chris Toshok  <toshok@helixcode.com>

	* mail-ops.c (fetch_mail_cleanup): new function, passed as arg to
	mail_operation_try.
	(fetch_mail): add cleanup func arg.

2000-06-22  Christopher James Lahey  <clahey@helixcode.com>

	* message-list.c: Changed ml_value_at to return "" instead of NULL
	in some cases.

2000-06-22  Peter Williams  <peterw@curious-george.helixcode.com>
	* Makefile.am: Add GNOME_EXTRA_LIBS so that we get libgthread
	in our LIBS for evolution-mail.
	
	* mail-threads.c: Make the dialog boxes for error and
	question non-modal. They're modal relative to the dispatch
	thread, but before they would also eg lock up the toolbar
	buttons (while the menus, managed by another process, were
	active -- a weird effect).
	
2000-06-22  Peter Williams  <peterw@curious-george.helixcode.com>

	* mail-threads.[ch]: Extra argument to mail_operation_try:
	'cleanup', a function to be called in the main thread after
	the dispatcher thread exits. gtk_object_destroy's et al may
	attempt to unmap windows so we can't do them in the dispatcher
	thread :-(

	* test-thread.c: Updated with demo of new argument working.

2000-06-22  Peter Williams  <peterw@helixcode.com>

	* test-thread.c (op_5): New tests for the get_password
	hook.

	* mail-threads.[ch]: New hook, mail_op_get_password, for
	getting a user response from an async operation. The operation
	blocks while waiting for the response. A big whole mutex 
	condition threading blocking dealie to make sure that it 
	works.

	Also the error hook creates a dialog again, which also needs
	to block its caller while we wait for the user to press ok.

2000-06-22  Peter Williams  <peterw@helixcode.com>

	* mail-threads.c (various functions): Prettify the UI
	so that the progress bar doesn't become all huge 'n stuff.
	(mail_operation_try): Now save the operation's description,
	so that we can display it later as the default message.
	(read_msg): When the operation starts set the label to its
	UI-friendly name.
	(dispatch_func): Free the saved prettyname.

2000-06-21  Christopher James Lahey  <clahey@helixcode.com>

	* message-list.c: Removed an erroneous comment.

2000-06-21  Dan Winship  <danw@helixcode.com>

	* mail-config.c (create_transport_page): Make this not crash if
	you don't have a transport configured.
	
	* message-list.c: Update received date to work like sent date.

2000-06-21  Peter Williams  <peterw@helixcode.com>

	* mail-thread.{c,h}: New files -- a simple API for executing
	the major mail ops (fetch_mail etc) asynchronously, allowing
	the operations to send messages and update a progress bar.

	* test-thread.{c,h}: Tests the mail-thread API.

	* Makefile.am: add mail-thread.[ch] to evolution_mail_SOURCES
	and declare the test_thread noinst_PROGRAM.

2000-06-21  Peter Williams  <peterw@helixcode.com>

	* mail-format.c (mail_generate_reply): Include "e-setup.h" to
	get the prototype for evolution_dir.

2000-06-20  Jeffrey Stedfast  <fejj@helixcode.com>

	* component-factory.c (create_imap_storage): Oops. Should
	have checked for a NULL sources.

2000-06-20  Dan Winship  <danw@helixcode.com>

	* message-list.c (mark_msg_seen): Quick hack to prevent a NULL
	pointer dereference. Things need to be cleaned up a bit more here
	though.

	* mail-sources.c: Oops. This should have been removed a long time
	ago.

2000-06-20  Jeffrey Stedfast  <fejj@helixcode.com>

	* folder-browser.c (folder_browser_load_folder): Working on getting 
	this to work :)

	* component-factory.c (create_imap_storage): Should now correctly
	construct the folder path allowing the selection of a folder.

2000-06-20  Ettore Perazzoli  <ettore@helixcode.com>

	* mail-format.c (mail_generate_reply): Declare `evolution_dir'.
	Ugly, ugly, ugly, but I am not sure where it should go instead.

2000-06-19  Ettore Perazzoli  <ettore@helixcode.com>

	* mail-ops.c (ask_confirm_for_empty_subject): New function to ask
	confirmation for an empty subject line.
	(composer_send_cb): Use it if the subject is empty and only send
	the message if the user confirms.

2000-06-20  Jeffrey Stedfast  <fejj@helixcode.com>

	* component-factory.c (create_imap_storage): Now creates the IMAP
	storage (listing subfolders and such)

2000-06-19  Dan Winship  <danw@helixcode.com>

	* mail-format.c (find_preferred_alternative): add an option to
	prefer text/plain.
	(reply_body): add an option to prefer text/plain
	(mail_generate_reply): Check the mail sending preferences, and
	generate a text/plain reply if the user prefers to send plain text
	(and we have a text/plain part to generate a reply from).

2000-06-19  Jeffrey Stedfast  <fejj@helixcode.com>

	* mail-config.c (providers_config_new): Should now correctly display
	the Transport page (made it set the optionmenu correctly, before it
	would only set SMTP).
	(create_transport_page): Updated to set the page info to sendmail/smtp
	based on the url.
	(create_service_page): Had to add some code to set data on some objects
	so I could grab the objects I needed to modify in the above function.

2000-06-18  Jeffrey Stedfast  <fejj@helixcode.com>

	* folder-browser.c (folder_browser_load_folder): started to add
	code to load an IMAP folder.
	
	* component-factory.c: Started to add a create_imap_storage 
	method so that we can eventually have our IMAP store displayed 
	in the tree view.
	(create_vfolder_storage): Renamed from
	create_test_storage().
	(owner_set_cb): Updated.

2000-06-17  Dan Winship  <danw@helixcode.com>

	* message-list.c (message_list_set_folder): Prevent double-freeing
	action on summary_table and uid_rowmap.

2000-06-16  Dan Winship  <danw@helixcode.com>

	* message-list.c (ml_set_value_at): Implement clicking on the
	envelope icon to set read/unread. Based on a patch by clahey.
	(select_msg): keep the timeout id for the "seen" flagging in the
	message_list structure, so ml_set_value_at can clear it so it
	doesn't re-mark a message seen after you click it unseen.

2000-06-16  Dan Winship  <danw@helixcode.com>

	* message-list.c (get_message_row): new function to do a uid to
	row mapping.
	(mark_msg_seen, select_msg, message_changed,
	message_list_set_folder): Update for Camel flag changes.
	(on_cursor_change_cmd): Rename "row_to_select" to "selected_row",
	and keep a "selected_uid" as well.

	* mail-ops.c (composer_send_cb): Update for Camel flag changes,
	and fix some memory-handling bugs. (Free the post_send_data when
	the composer is destroyed, not when the user clicks "send", which
	could happen never, or more than once.)
	(delete_msg): Update for Camel flag changes, and fix the "holding
	down the delete key skips some messages" bug.

2000-06-15  Dan Winship  <danw@helixcode.com>

	* mail-ops.c (fetch_mail): 
	* component-factory.c (owner_unset_cb): 
	* message-list.c (message_list_set_folder): Update for CamelFolder
	changes.

	* folder-browser.c (folder_browser_clear_search): New function to
	revert back to non-searching mode.

	* mail-ops.c (fetch_mail): Use folder_browser_clear_search.

	* mail-display.c (on_url_requested): if the document requests an
	unknown URL, it's not an error; just ignore the URL.

	* mail-ops.c (fetch_mail): If there's no new mail, tell the user.

2000-06-14  Radek Doulik  <rodo@helixcode.com>

	* main.c (main): call gtkhtmllib_init here

2000-06-13  Jeffrey Stedfast  <fejj@helixcode.com>

	* mail-config.c (on_SourceConfigDialogButton_clicked): Make sure source
	is always pointing to something, so a blank is not written to the config file
	on close.

2000-06-13  Ettore Perazzoli  <ettore@helixcode.com>

	* Makefile.am (SHELL_OBJS): Removed.
	(evolution_mail_LDADD): Use `libeshell.a'.  Also use
	`top_builddir' consistently.

2000-06-12  Jeffrey Stedfast  <fejj@helixcode.com>

	* mail-config.c: Got rid of sources_max_row and identities_max_row
	as they are not really needed (just use clist->rows)
	(on_cmdSourcesEdit_clicked): Modified to make 'source'
	point to the data being edited.
	(on_cmdSourcesAdd_clicked): Adds a new clist item and selects it so the
	editor knows where to stick the data when it's done.

2000-06-12  Federico Mena Quintero  <federico@helixcode.com>

	* message-list.c: Removed the ETableModel thaw handler.

2000-06-12  Dan Winship  <danw@helixcode.com>

	* folder-browser.c (folder_browser_set_uri): Return the result of
	folder_browser_load_folder.
	(get_prop, set_prop, folder_browser_properties_init): Remove. No
	longer needed.

	* folder-browser-factory.c (folder_browser_factory_new_control):
	Add a "uri" argument, return NULL if setting it fails.
	(folder_browser_factory_new_control): Remove property bag stuff.
	(folder_browser_factory_init, folder_browser_factory): Remove
	this, since we're using the component factory now.

	* component-factory.c (create_view): Update for
	folder_browser_factory_new_control change and return NOTFOUND as
	appropriate.

	* main.c (main): Don't call folder_browser_factory_init.

	* mail-format.c (mail_generate_reply): Fix the subject generation
	so we don't get "Re:  Re:". This is working around something that
	may later be declared a misfeature in Camel.

2000-06-10  Ettore Perazzoli  <ettore@helixcode.com>

	* component-factory.c (create_folder): New stub implementation for
	the folder creation function in the EvolutionShellComponent we
	expose [it simply returns success all the time].
	(factory_fn): Pass this function to `evolution_shell_component_new'.

2000-06-09  Dan Winship  <danw@helixcode.com>

	* folder-browser.c (folder_browser_new): Add a serial number to
	FolderBrowser.

	* folder-browser-factory.c (control_activate, control_deactivate):
	Include fb serial number in the name of the Bonobo toolbar to
	prevent problems with disappearing toolbars. This is a kludge and
	should go away.


	* mail-ops.c (expunge_folder): display error from
	camel_folder_expunge if there is one.

	* message-list.c (select_row): install an idle function to
	select the row rather than doing it directly. Ugh. What a
	kludge, but at least it works now.

	* session.c (evolution_auth_callback): Update for
	CamelAuthCallback changes. (Uncache passwords when asked to.)

	* mail-ops.c (fetch_mail): close and expunge the source folder
	after copying it to a local folder.

2000-06-09  Ettore Perazzoli  <ettore@helixcode.com>

	* component-factory.c (create_view): Updated to match the changes
	to the definition of `EvolutionShellComponentCreateFn'.  If @type
	is not "mail", return an "unsupported type" error.
	(factory_fn): Pass NULL for the `remove_folder' and
	`create_folder' functions.

2000-06-09  Dan Winship  <danw@helixcode.com>

	* mail-format.c: Redo things a bit so that whitespace-only
	text parts aren't displayed. (In particular, so that
	whitespace-only subparts of multipart/mixed aren't displayed as
	separate (empty) parts.)

2000-06-06  Dan Winship  <danw@helixcode.com>

	* mail-ops.c (fetch_mail): 
	* folder-browser.c (folder_browser_load_folder): Update for folder
	creation/existence changes.

	* message-list.c (message_list_set_folder): Remove the code to
	create the folder if it doesn't exist, since we don't want to do
	that.

2000-06-05  Dan Winship  <danw@helixcode.com>

	* mail-ops.c (composer_send_cb): Leave the composer window around
	if the message doesn't get sent.

2000-06-05  Matt Loper  <matt@helixcode.com>

	* folder-browser.c (etable_key): Allow "GDK_KP_Delete", a keypad
	delete key, to delete a message.

2000-06-05  Dan Winship  <danw@helixcode.com>

	* session.c (evolution_auth_callback): Remember passwords between
	calls.
	(forget_passwords): Callback for "Forget Passwords" menu item.

	* folder-browser-factory.c (control_activate): 
	(control_deactivate): Add "Forget Passwords" menu item.

	* mail.h, mail-ops.c: fix some function prototypes

	* folder-browser.c (etable_key): Add "Delete" = delete message.

	* mail-format.c (mail_generate_forward): Update for new composer
	attachment interface.

2000-06-02  Jeffrey Stedfast  <fejj@helixcode.com>

	* mail-config.c (providers_config_new): Added a new notebook
	page that allowed for mail format (text/plain or 
	multipart/alternative)

2000-06-02  Dan Winship  <danw@helixcode.com>

	* message-list.c (filter_date): If the date in the summary is 0,
	output "?".

	* component-factory.c (create_view): keep a GList of folder
	browsers created
	(owner_unset_cb): Go through the list and close each folder before
	exiting so they sync their summary state, etc to disk.

	* mail-ops.c (fetch_mail): Use camel_service_connect, not
	connect_with_url, since we already passed the URL into
	camel_session_get_store.

2000-06-02  Christopher James Lahey  <clahey@helixcode.com>

	* message-list.c: Use camel_folder_free_summary instead of
	g_ptr_array_free.  Unref the folder when we're done with it.

2000-06-02  Christopher James Lahey  <clahey@helixcode.com>

	* session.c: Revert removal of e_setup_base_dir.

2000-06-02  Dan Winship  <danw@helixcode.com>

	* folder-browser.c (my_folder_browser_init): Connect to ETable's
	key_press signal.
	(etable_key): scroll mail on space/backspace.

2000-06-02  Christopher James Lahey  <clahey@helixcode.com>

	* message-list.c: Made sent column as wide as from column.

2000-06-02  Jeffrey Stedfast  <fejj@helixcode.com>

	* mail-config.c (on_cmdSourcesAdd_clicked): Changed identity_row
	to source_row as this is a Sources clist we are dealing with and
	not an identity clist
	(on_cmdSourcesEdit_clicked): same
	(on_cmdSourcesDelete_clicked): again, same
	(on_cmdSourcesEdit_clicked): Source editor now fills in data from
	the clist

2000-06-01  Dan Winship  <danw@helixcode.com>

	* message-list.c: Add a date column.	
	(COL_SENT_WIDTH_MIN): Make this wider.
	(ml_value_at): return the sent date (as a time_t) for COL_SENT.
	(Fix COL_TO too while I'm here.) 
	(ml_duplicate_value, ml_free_value, ml_initialize_value,
	ml_value_is_empty): COL_SENT is numeric now.
	(message_list_init_renderers): Create a date renderer (using
	text_filter to translate the time_t into a string).
	(message_list_init_header): Use render_date for COL_SENT.

2000-06-01  Christopher James Lahey  <clahey@helixcode.com>

	* session.c: Don't call e_setup_base_dir.

2000-06-01  Dan Winship  <danw@helixcode.com>

	* mail-format.c (mail_generate_forward): Fix forwarding to work
	for people other than me. :) [Although apparently it doesn't
	really.]

	* mail-ops.c (delete_msg): Add a quick hack to move the selection
	down a row when you delete a message.

	* mail-format.c (handle_message_rfc822): use <blockquote> rather
	than <center><table border=1 width=95%> to frame the embedded
	message. If <pre> text in the subtable won't fit in the 95% width,
	GtkHTML will write past the border of the table (and
	<blockquote><table border=1> causes creeping updates so it's not
	usable for now).
	
2000-06-01  Christopher James Lahey  <clahey@helixcode.com>

	* message-list.c (message_list_init): Turn off the grid in our
	ETable.

2000-06-01  Dan Winship  <danw@helixcode.com>

	* mail-format.c (write_headers): Oops. This needs to take a
	message argument because we might be writing headers for an
	embedded message/rfc822 subpart rather than the root document.

2000-06-01  Jeffrey Stedfast  <fejj@helixcode.com>

	* mail-config.c: Config dialogs are completed.
	(service_acceptable): Fixed a segfault caused by duplicate 
	camel_exception_free()
	(providers_config_new): Identity and Source clists are now filled in
	when the dialog is created as well as the Transport page

	* folder-browser-factory.c: Renamed Tool/ menu items
	Vfolder was changed to Virtual Folder and
	Configure Camel Providers was changed to Mail Configuration

2000-06-01  Ettore Perazzoli  <ettore@helixcode.com>

	* Makefile.am (evolution_mail_LDADD): Link with
	`libemiscwidgets.a'.

	* mail-display.c (mail_display_new): Use an EScrollFrame instead
	of a GtkScrolledWindow.
	(mail_display_set_message): Likewise.

	* mail-display.h: Replace the GtkScrolledWindow with an
	EScrollFrame.

2000-06-01  Dan Winship  <danw@helixcode.com>

	* component-factory.c (owner_unset_cb): Quit when the shell exits.
	This is a kludge, but a pretty necessary one until the refcounting
	bugs that keep the component from exiting properly are fixed.

2000-05-31  Jeffrey Stedfast  <fejj@helixcode.com>

	* mail-config.c: Partially implemented the source
	configuration, seems to segfault due to a destroyed
	gnome dialog being destroyed again in the method
	on_SourceConfigDialogButton_clicked()

2000-05-31  Dan Winship  <danw@helixcode.com>

	* mail-format.c (free_url, handle_text_enriched,
	get_url_for_icon): Fix up memory management of x-evolution-data
	URLs so the URLs and/or their data don't get freed while there are
	still references to them.

	* message-list.c (message_list_init_header): redo the (unused)
	online status column to no longer refer to pixmaps that no longer
	exist.

2000-06-01  Ettore Perazzoli  <ettore@helixcode.com>

	* folder-browser-factory.c (control_activate): Put the toolbar
	into a frame to make it look like standard GNOME toolbars.  Also,
	set `GNOME_DOCK_ITEM_BEH_NEVER_VERTICAL' so that it does not do
	evil things when its moved to the left or the right of the window.

2000-05-31  Jeffrey Stedfast  <fejj@helixcode.com>

	* mail-config.c: Configuration dialog now allows 
	adding/editing/deleting of Identities (which leaves
	adding/editing/deleting of sources left to implement).
	The data is also saved when the dialog is exited via 
	the OK button.

2000-05-31  Dan Winship  <danw@helixcode.com>

	* mail-format.c (mail_format_mime_message): Initialize the "urls"
	hash table stored on the message and store cid and other URLs
	there rather than as object data on the message.
	(get_cid): rewrite this a bunch
	(handle_text_enriched): move the code from write_iframe_string()
	into here, since it's the only place that actually needs it.
	(handle_text_html): simplify this a lot. We can use a cid: URL
	here rather than x-evolution-data.
	(get_url_for_icon): New routine to return URLs for icons, and
	cache the results, so we don't have to keep re-reading the icon
	files (and so we can't be spoofed into reading non-icon files).
	(handle_mystery, handle_audio): use get_url_for_icon.

	* mail-display.c (save_data): move the CamelMimePart filename
	extracting code from get_cid to here.
	(on_link_clicked, on_object_requested): Update for cid: changes.
	(on_url_requested): Kill off the kludgy, exploitable x-gnome-icon
	URL schema, update cid and x-evolution-data to match
	mail-format.c.

	It should now be easier to implement RFC 2557 (Content-Location,
	etc), but that RFC still pretty much sucks.

2000-05-30  Dan Winship  <danw@helixcode.com>

	* mail-format.c: Redo this back to the old way: a single GtkHTML
	with various things inline in it. (Gets rid of flicker, simplifies
	some scrolling, selecting, and printing issues.)
	(handle_text_enriched, handle_text_html): Use <iframe>s for these,
	to protect the rest of the document from their possibily invalid
	HTML.
	(handle_via_bonobo): Use (new-and-improved) <object> tags for
	this, moving most of the work back into mail-display.c

	* mail-display.c (on_object_requested): Move the Bonobo embedding
	code back here again (reorganized a bit).
	(on_url_requested): add x-evolution-data handler, for iframe
	bodies.
	(mail_html_new, mail_html_end): removed
	(mail_display_set_message, mail_display_new): Update for NWO.

2000-05-30  Not Zed  <NotZed@HelixCode.com>

	* folder-browser.c (search_set): Properly encode the search string.

2000-05-30  Jeffrey Stedfast  <fejj@helixcode.com>

	* mail.h: Added a prototype for providers_config_new() which
	is the constructor for the configuration dialog window

	* mail-config.c: Added set_service_url() which is basically
	the reverse of get_service_url().
	Implemented on_cmdCamelServicesOK_clicked() - The configuration
	window will now remember the Sendmail/SMTP data that the user
	had entered in the previous session.
	Removed on_cmdCamelServicesApply_clicked() - No need for this.

2000-05-30  Dan Winship  <danw@helixcode.com>

	* message-list.c (message_changed): call
	e_table_model_row_changed, not e_table_model_changed so we do less
	work, and don't lose the current selection.
	(select_msg): Set up a timer to mark the displayed message as
	"seen" if it's selected for longer than 1.5 seconds (a number
	pulled out of Matt's butt).
	(ml_value_at): Use the MESSAGE_STATUS column for read/unread as
	well as deleted.

	* message-list.c: use the "new" tigert pixmaps rather than the
	older ones. Includes a "replied to" icon (which is used now), but
	no "deleted" icon (although we have the strikeout renderer for
	that now).

2000-05-30  Christopher James Lahey  <clahey@helixcode.com>

	* message-list.c, message-list.h: Added bold for unread messages.

2000-05-30  Jeffrey Stedfast  <fejj@helixcode.com>

	* mail.h: Added a prototype for providers_config()
	which is the callback for a new menu item that
	will construct a configuration dialog for the camel
	providers and identities and display it

	* mail-config.c: Added some code to construct the 
	new providers dialog and a bunch of callbacks (most 
	of which are not yet useful)

	* mail-ops.c: Added the code for the providers_confi()
	callback

	* folder-browser-factory.c: Added the 
	"Tools/Camel Providers Configuration ..." menu item

2000-05-30  Christopher James Lahey  <clahey@helixcode.com>

	* message-list.c: Switched to using "cursor_change" signal instead
	of "row_selection" for switching messages.  Select the first row
	(still doesn't work because of ETable.)  Adapt to some small
	ETable changes.  Set drawfocus to FALSE.

2000-05-29  Not Zed  <NotZed@HelixCode.com>

	* folder-browser.c (folder_browser_load_folder): Hardcode the
	vfolder source to just the inbox (so at least it returns
	something).

	* component-factory.c (create_test_storage): Create a vfolder dir
	first, and put the folders in that.
	(create_test_storage): Create the storage as VFolders, not
	"storage_name" :)

2000-05-28  Dan Winship  <danw@helixcode.com>

	* mail-config.c (error_dialog): helper function since we need to
	set "modal" on the dialogs returned by gnome_error_dialog to make
	them work when popped up from the modal Druid.
	(service_acceptable): New function to check if the info entered on
	a store/transport page actually checks out.
	(mail_config_druid): Connect to the "next" signal on the store and
	transport pages and don't let the user continue if the data is
	bad and "check this before continuing" is checked. Also, only
	display sources/transports in the "mail" domain. (Ie, not
	"vfolder".)

	* mail-format.c (write_recipients_to_stream): Use `foo@bar' rather
	than `<foo@bar>' for recipient with no name.

	* mail-ops.c (fetch_mail): don't put up an error message if the
	user cancels the password dialog.

2000-05-27  Not Zed  <NotZed@HelixCode.com>

	* Makefile.am (SHELL_OBJS): Include mail storage so we can
	initialise folders.

	* component-factory.c (create_test_storage): Parses vfolder
	defintions and adds them to the storage.  Definetly needs more
	work.

	* folder-browser-factory.c (control_activate): Add the VFolder
	druid menu item.
	(control_deactivate): And remove it.

	* mail-ops.c (vfolder_editor_clicked): For editing vfolder
	definitions (rather like filters, oddly enough :).  Tries to
	update the shell but it doesn't seem to work properly - requires a
	mail component restart to take effect.

	* folder-browser.c (folder_browser_load_folder): Handle vfolder:
	urls' appropriately and map to camel.  Still needs a way to tell
	the vfolder what folders to search! (all vfolders come up empty!).

2000-05-28  Christopher James Lahey  <clahey@helixcode.com>

	* message-list.c, message-list.h: Added a COL_DELETED and made it
	the strikeout column for both text renderers.

2000-05-27  Dan Winship  <danw@helixcode.com>

	* mail-format.c: Various improvements:

	(call_handler_function, etc): Add a "mime_type" argument to the
	handlers, so that if a part is tagged as
	"application/octet-stream", and we figure out that it's really
	something else, the handler we call can know what that something
	else is.

	(handle_text_enriched): Small fixes to make this not do
	text/enriched-specific syntax in text/richtext or vice versa.

	(handle_mystery): Allow for mystery data that can't even be saved
	to disk. (ie, unrecognized external-body). Let the caller specify
	the URL to use.

	(handle_message_external_body): New function to deal with
	message/external-body parts. Generates URLs for anon-ftp,
	local-file, and URL access-types, and a more-useful-than-before
	descriptive message for other types.

	(handle_audio, handle_undisplayable): Use gnome_mime_get_value to
	try to get a description of the MIME type to display to the user
	rather than the raw form. (This will only work if the user has
	recent gnome-vfs installed. [If they don't, it works just like
	it used to.])

2000-05-26  Dan Winship  <danw@helixcode.com>

	* mail-format.c (handle_text_html): Fix a bug (security/stability)
	in its usage of mail_html_write.

	* mail-ops.c (composer_send_cb, reply): set CAMEL_MESSAGE_ANSWERED
	on a message after a successful reply.

	* message-list.c (folder_changed): free the summary with
	camel_folder_free_summary rather than g_ptr_array_free.

	* mail-format.c (handle_via_bonobo): Update for PersistStream
	changes

2000-05-25  Ettore Perazzoli  <ettore@helixcode.com>

	* main.c (main): Initialize the component factory.

	* Makefile.am (evolution_mail_LDADD): Link with
	`evolution-shell-component.o' from the shell directory.

	* evolution-mail.oafinfo: Updated with the
	Evolution::ShellComponent OAFIID.

	* evolution-mail.gnorba: Updated with the
	Evolution::ShellComponent GOAD ID.

	* folder-browser-factory.c (folder_browser_factory_new_control):
	New function; code moved out from `folder_browser_factory'.
	(folder_browser_factory): Use it.

	* component-factory.c: New.
	* component-factory.h: New.

2000-05-24  Dan Winship  <danw@helixcode.com>

	* mail-ops.c (composer_send_cb): connect to and disconnect from
	the transport.

2000-05-24  Christopher James Lahey  <clahey@helixcode.com>

	* Makefile.am: Added libepaned.a.
	
	* folder-browser.c: Switched from GtkPaned to EPaned.

2000-05-23  Ettore Perazzoli  <ettore@helixcode.com>

	* Makefile.am: Don't link to `evolution-service-repository.o'
	anymore.

	* folder-browser-factory.c: Don't use crufty service-repository
	anymore.

2000-05-21  Ettore Perazzoli  <ettore@helixcode.com>

	* message-list.c (get_message_info): Made static.
	(ml_initialize_value): Return NULL to placate compiler.

	* folder-browser.c (folder_browser_gui_init): Add cast.

	* mail-display.c (mail_html_new): Don't pass an empty URL to
	`gtk_html_begin()' anymore.

	* mail-config.c (put_html): Don't pass an empty URL to
	`gtk_html_begin()' anymore.

	* mail-display.h: Updated for the new GtkHTML API that uses
	`GtkHTMLStream *' instead of `GtkHTMLStreamHandle'.
	* mail-display.c: Likewise.
	* mail-config.c: Likewise.
	* mail-format.c: Likewise.

2000-05-19  NotZed  <NotZed@HelixCode.com>

	* mail-format.c: Fixes for stream stuff.

	* mail-display.c (save_data_cb): Remove exception stuff on streams.

2000-05-19  Christopher James Lahey  <clahey@helixcode.com>

	* message-list.c: Added initialize_value and value_is_empty
	callbacks.

2000-05-18  Dan Winship  <danw@helixcode.com>

	* folder-browser-factory.c (folder_browser_factory): Remove
	development_warning (moved to shell)

	* message-list.c (select_msg): Update for camel_folder_get_uids
	(folder_changed, message_list_set_folder): Update for
	camel_folder_get_summary

	* mail-ops.c (fetch_mail): Update for camel_folder_get_uids

2000-05-17  Dan Winship  <danw@helixcode.com>

	* mail-component.c: This seems to be cruft. Nuke it.

	* mail-display.c (save_data_cb, save_data, on_url_requested):
	* mail-format.c (handle_text_plain_flowed, handle_text_html):
	Use camel_data_wrapper_write_to_stream rather than
	camel_data_wrapper_get_output_stream.

2000-05-16  NotZed  <NotZed@HelixCode.com>

	* mail-ops.c (filter_edit): Function to bring up the filter editor.
	(filter_druid_clicked): Save/close dialogue.
	(fetch_mail): Apply filters to incoming mail ... *hold breath*
	If we are coming from a non-indexed/searchable/etc source, then
	copy it to an mbox first.  When copying mail from an mbox source,
	dont remove it aftewards, open it for append, so partially
	filtered mail isn't lost.

	* Makefile.am (evolution_mail_LDADD): Added libfilter.
	(INCLUDES): Add EVOLUTION_DATADIR, and fix matt's brokeneditor(tm)
	for putting spaces instead of tabs in.

2000-05-16  Christopher James Lahey  <clahey@helixcode.com>

	* mail-format.c: Removed usage of bonobo_object_destroy.

2000-05-14  Christopher James Lahey  <clahey@helixcode.com>

	* message-list.c: Updated to work with new ETable resizing.

2000-05-12  NotZed  <NotZed@HelixCode.com>

	* mail-ops.c (fetch_mail): Use 6 X's to mkstemp, as required by
	the man page, just a temp fix, this should probably change to a
	known filename.

2000-05-11  Dan Winship  <danw@helixcode.com>

	* folder-browser-factory.c (control_activate): Now that we depend
	on current gnome-libs we can make the toolbar detachable again.

2000-05-11  Federico Mena Quintero  <federico@helixcode.com>

	* folder-browser-factory.c (development_warning): Left-justify the
	message.

2000-05-10  Christopher James Lahey  <clahey@helixcode.com>

	* folder-browser-factory.c (development_warning): Made this dialog
	have fewer buttons.

2000-05-10  Christopher James Lahey  <clahey@helixcode.com>

	* folder-browser-factory.c (development_warning): New development
	warning text from Nat.

2000-05-10  Larry Ewing  <lewing@helixcode.com>

	* mail-config.c (html_new): only set the default background color
	if style is not NULL.

2000-05-09  Christopher James Lahey  <clahey@helixcode.com>

	* Makefile.am: Removed folder-browser-factory.h since it doesn't
	exist.  Added mail-display.h, mail-types.h, pixmaps.h.

2000-05-09  Matt Loper  <matt@helixcode.com>

	* folder-browser-factory.c (control_activate): Remove "File->mail"
	menuitem.

	* mail-config.c (mail_config_druid): Fill in "blah blah blah".

2000-05-09  Dan Winship  <danw@helixcode.com>

	* folder-browser.c (folder_browser_load_folder): make this a
	little less kludgy. Use gnome_error_dialog rather than printf on
	errors.

	* mail-ops.c (fetch_mail): Fix to work with the new shell stuff...
	sorta. Will need more fixing later when the new shell framework is
	more done.

	* mail-config.c (finish): Call gnome_config_sync so the data
	actually gets written.

2000-05-08  Dan Winship  <danw@helixcode.com>

	* mail-display.c (save_data_cb):
	(on_url_requested): Update for CamelStream CamelException changes.

	* mail-format.c: Pass NULL for a CamelException in a bunch of
	places... the user will see that the data is not being displayed,
	and there's not a lot we can do, and none of these things should
	be failing anyway. Maybe fix this later.

2000-05-07  NotZed  <NotZed@HelixCode.com>

	* message-list.c (ml_value_at): Size moved to message info, rather
	than content info structure.

2000-05-07  Dan Winship  <danw@helixcode.com>

	* message-list.c (select_msg): unref the message after displaying
	it.

	* mail-format.c (get_data_wrapper_text):
	(handle_text_plain_flowed): 
	(handle_via_bonobo): Replace camel_stream_close calls.

2000-05-07  Matt Loper  <matt@helixcode.com>

	* folder-browser-factory.c: Changed a toolbar button from saying
	"New mail" (which suggests you might be composing new mail) to
	"Get mail".

2000-05-06  Dan Winship  <danw@helixcode.com>

	* folder-browser-factory.c (folder_browser_factory): Don't
	hardcode "inbox" here.

	* folder-browser.c (folder_browser_set_uri): Don't hardcode
	"inbox" here either.
	(folder_browser_load_folder): Create a new store according to the
	folder browser's URI, and load the mbox file from that store.
	Parts of this are temporary.

	* session.c, mail.h: There is no longer a global store, just a
	global session.

	* mail-config.c, mail-ops.c: Update for default_session -> session
	change. fetch_mail is currently broken.

2000-05-06  Dan Winship  <danw@helixcode.com>

	* mail-config.c: New code to configure identity, mail source, and
	mail transport.
	(mail_config_druid): A druid using the config widgets. (Only
	allows configuration of a single identity, source, and transport.)

	* mail-ops.c (check_configured): New function to make sure the
	user has configured stuff, and call the	druid if not.
	(fetch_mail, send_msg, send_to_url, reply, forward_msg): Call
	check_configured
	(composer_send_cb): Make this pass the message to a CamelTransport
	rather than just printing it to stdout.

	* folder-browser-factory.c (development_warning): Add a warning
	about sending mail, since you can do that now.

2000-05-06  Chris Toshok  <toshok@HelixCode.com>

	* .cvsignore: ignore evolution-mail.pure

	* Makefile.am: add support for building evolution-mail.pure

2000-05-06  Dan Winship  <danw@helixcode.com>

	* mail.h: consolidate mail-format.h, mail-identify.h, mail-ops.h,
	main.h and session.h into this new file. There's no reason to have
	a .h for every .c.

2000-05-05  Anders Carlsson  <andersca@gnu.org>

	* test-mail.c (create_container): Use the OAFIID when using an 
	OAF-enabled build of bonobo.

2000-05-04  NotZed  <NotZed@HelixCode.com>

	* message-list.c (message_list_set_folder): Get the whole message
	summary right away.
	(folder_changed): And if we change too.
	(ml_row_count): Use the match count or summary table length as the
	row count.
	(get_message_info): Use array references to lookup message summary
	info.  For the search result list, use the summary_search_cache to
	cache the info lookup.
	(message_list_init): Allocate the summary search cache.
	(message_list_destroy): Free the summary search cache and the
	summary table, if there is one to free.
	(message_list_set_search): Save the match count, and clear the
	summary search cache for reuse.
	(folder_changed): Re-retrieve the summary list if the folder has
	changed.
	(message_list_set_folder): Retrieve the summary list when opening
	the folder.

2000-05-03  Jason Leach  <leach@wam.umd.edu>

	* Makefile.am (evolution_mail_LDADD): s/-lunicode/$(UNICODE_LIBS)/
	in the LDADD section.

2000-05-03  Dan Winship  <danw@helixcode.com>

	* mail-format.c (write_recipients_to_stream, write_headers): Make
	the "Cc:" field optional again. (Before, we could check if
	camel_mime_message_get_recipients returned NULL, but now we need
	to actually look into the returned CamelInternetAddress object.)

2000-05-03  Larry Ewing  <lewing@helixcode.com>

	* folder-browser.c (folder_browser_gui_init): comment out the
	changed signal for now.

2000-05-02  Matt Loper  <matt@helixcode.com>

	* Makefile.am: set G_LOG_DOMAIN.

2000-05-02  Larry Ewing  <lewing@helixcode.com>

	* message-list.c (message_list_set_search): only free search if it
	is not NULL.

2000-05-02  NotZed  <NotZed@HelixCode.com>

	* folder-browser.c (folder_browser_gui_init): Connect the changed
	signal to search, so it searched immediately?

2000-05-01  NotZed  <NotZed@HelixCode.com>

	* pixmaps.h: Added envelope-deleted state.

	* folder-browser-factory.c: Setup callback for actual delete op.
	(control_activate): Setup a tool menu item to expnge deleted
	messages.

	* mail-ops.c (delete_msg): Toggle the delete flag on a message.
	(expunge_folder): New function to expunge deleted messages from
	the current folder.

	* folder-browser.c (folder_browser_gui_init): A hackish little
	quick-search entry.
	(search_activate): Perform a quick-search on the folder subject
	only.
	(folder_browser_gui_init): Add an option meny to the search line.	
	(create_option_menu): Build the option menu from a table.
	(search_set): Build a search from another string whent he option
	menu or text item is changed.  5 search options are defined so
	far.

	* message-list.c (get_message_info): If there is an active search,
	then get the data from that ... use this instead of
	_get_message_info().
	(ml_row_count): If we have an active search, get the info from its
	result.
	(select_msg): Changed to use get_message_info, so searches work.
	(ml_value_at): And same here.
	(message_list_init_renderers): Added a 3rd state to message_status
	= deleted.
	(ml_value_at): Show the message state as deleted, if it is marked
	for deletion.
	(folder_changed): When the folder changes, update the display.
	(message_list_set_folder): Connect to the folder_changed event
	here.
	(message_changed): Callback to update the display when the message
	changes.
	(select_msg): And connect to the message_changed signal so we know
	when it cahgnes.
	(message_list_set_search): Save the search string.
	(folder_changed): If the folder changes, re-run the search,
	otherwise we may end up with invalid entries in the display.

	* mail-display.c: Include missing errno.h.

2000-04-30  Dan Winship  <danw@helixcode.com>

	* session.c (session_providers_init): This is no longer necessary.

	* mail-ops.c (fetch_mail): Remove kludge to load remote provider,
	as camel can do it by itself now.

2000-04-29  Dan Winship  <danw@helixcode.com>

	* mail-display.c (on_link_clicked): Handle clicks on "cid" URLs by
	popping up a "Save Attachment" dialog.

	* mail-format.c (get_cid): if the part has a Content-Disposition
	with a filename specified, record (a sanitized version of) that on
	the wrapper when creating the cid reference, so the "save
	attachment" code can use it later.
	(handle_mystery): fix a bug in the cid generation here.

2000-04-29  Dan Winship  <danw@helixcode.com>

	* mail-format.c (lookup_handler, etc): Improve the builtin vs
	bonobo selection code.
	(handle_mystery): Include name and Content-Description in the
	"mystery data" info, when available
	(handle_unknown_type): Call mail_identify_mime_part before
	giving up.
	(handle_undisplayable): Split out of handle_unknown_type now
	that handle_unknown_type can try alternate viewers.
	(handle_via_bonobo): Fall back to handle_undisplayable if the
	bonobo control fails.

	* mail-identify.c (mail_identify_mime_part): New function to
	attempt to identify a MIME part that we can't identify based on
	Content-Type alone.

	* mail-display.c (on_url_requested): redo the mystery data icon
	display stuff less kludgily.

2000-04-28  Dan Winship  <danw@helixcode.com>

	* mail-format.c (write_recipients_to_stream, write_headers,
	mail_generate_reply): Update (minimally) for Camel recipient
	changes.

2000-04-28  Ettore Perazzoli  <ettore@helixcode.com>

	* main.c (init_bonobo): Don't call `init_corba()' and don't get
	any args.
	(init_corba) [!USING_OAF]: Fix args.

2000-04-27  Ettore Perazzoli  <ettore@helixcode.com>

	* folder-browser-factory.c: New macro `CONTROL_FACTORY_ID', which
	is #defined to a different value according to whether we are
	`USING_OAF' or not.
	(folder_browser_factory_init): Use `CONTROL_FACTORY_ID'.

	* test-mail.c
	(init_corba): New helper function, implemented differently
	according to `USING_OAF'.
	(main): Use `init_corba()'.

	* main.c
	(init_corba): New helper function, implemented differently
	according to `USING_OAF'.
	(init_bonobo): Use `init_corba()'.

	* Makefile.am: Install OAF stuff if `USING_OAF'.  Add
	`-I$(datadir)/idl' to the `orbit-idl' command-line so that we can
	use Bonobo IDL files installed under our prefix as well.  Also,
	use `$(ORBIT_IDL)' instead of hardcoded `orbit-idl'.

	* evolution-mail.oafinfo: New file.

2000-04-27  Dan Winship  <danw@helixcode.com>

	* mail-format.c: Move text_to_html to e-util.

	* mail-ops.c (send_to_url): New routine. Thin wrapper for
	e_msg_composer_new_from_url.

	* mail-display.c (on_link_clicked): print a warning for news or
	nntp URLs (which we'll deal with some day), and call send_to_url
	for mailto URLs.

	* mail-format.c (text_to_html): Improve URL conversion code.
	Recognize https, recognize "www\..*" without a prefixed "http://".
	Properly escape &, <, >, etc in URL strings. Don't be fooled by
	"mailto:", "http://", etc with no following data.

2000-04-26  Dan Winship  <danw@helixcode.com>

	* mail-format.c (text_to_html): Reorganize a bit and add a new
	flag, TEXT_TO_HTML_CONVERT_URLS to recognize and wrap URLs
	in text.

	* mail-display.c (mail_html_new): Add link_clicked signal handler.
	(on_link_clicked): Use gnome_url_show to launch a browser.

	* mail-format.c: update for CamelStream changes. Update for
	CamelMimeBodyPart -> CamelMimePart

2000-04-25  Dan Winship  <danw@helixcode.com>

	* mail-display.c, mail-format.c: Redo large chunks of this. The
	mail display now consists of a vbox in a scrolled window, in which
	we put multiple GtkHTML objects. This means broken HTML in one
	part can't corrupt other parts. The headers now scroll with the
	body. Unrecognized attachments look prettier, but still don't do
	anything, and will probably be changed later. We can also now
	display nested message/rfc822 parts and multipart/alternatives
	with multipart subparts. Oh, and text/{richtext,enriched}, since
	we had all these ancient sample messages that use it and the lack
	of support annoyed me. :)

	Bonobo embeddables are broken right now, but I don't think that's
	my fault.

	* mail-format.c (reply_body): Fix some bugs that crept into reply
	generation. This needs a lot more work to deal correctly with
	complicated bodies.
	(setup_function_table): pass unknown text subtypes to
	handle_text_plain.
	(handle_multipart_appledouble): new handler. Just ignores the
	first (application/applefile) part and tries to display the
	second part. Since the second part is usually
	application/octet-stream, this doesn't work very well still
	usually.
	(reply_body): Make this deal better with multiparts.

	* mail-format.c, mail-display.c: Now that we're not limited to
	a single GtkHTML for the display, there's no reason to embed
	Bonobo objects for unrecognized content-types in GtkHTML rather
	than embedded them into the vbox directly. So do that.

	Meanwhile, fix up the handler-selection code so that we can
	declare which built-in handlers are more desirable than external
	handlers and which are less. (Of course, eventually we'll want
	this to be customizable.) Add some cleverness to
	handle_multipart_alternative as well so it doesn't accept an
	alternative which we can display generically over one we can
	display specifically.

	* mail-format.c (text_to_html): add a convert_space_hack flag,
	which turns N spaces into N-1 &nbsp;s and a space.
	(handle_text_plain): Check for "format=flowed" in the
	Content-Type.
	(handle_text_plain_flowed): Spinoff of handle_text_plain to deal
	with RFC 2646 flowed text. (All the examples I can find of it
	are generated by Eudora, but it's a pretty cool idea that ought
	to be used more widely.)

2000-04-23  Dan Winship  <danw@helixcode.com>

	* folder-browser-factory.c: rename "send" to "send_msg", to avoid
	name clash with the tcp function. Connect the "forward" button.

	* mail-ops.c: rename "send" to "send_msg", to avoid name clash
	with the tcp function. Add forward_msg function.

	* mail-format.c (mail_generate_forward): support function for
	forward_msg. Pretty much a big kludge right now, pending the
	attachment/attachment-bar changes.

2000-04-22  Dan Winship  <danw@helixcode.com>

	* mail-display.c (on_url_requested): Change cid expectations to
	match current camel reality.

	* main.c (main): call glade_gnome_init, for composer.

	* folder-browser-factory.c: move msg_composer_cb and
	msg_composer_send_cb to mail-ops. Attach send, reply, and "reply
	to all" buttons.

	* mail-ops.c (composer_send_cb, send): moved from
	folder-browser-factory.c.
	(reply_to_sender, reply_to_all): new functions to do replies.

	* mail-format.c (text_to_html): Add an "add_pre" flag, to make
	it wrap the output in <pre></pre>.
	(mail_generate_reply): New function to create a composer and build
	a reply in it.

2000-04-21  Dan Winship  <danw@helixcode.com>

	* mail-display.c (on_url_requested): deal with cid: URLs.
	(find_cid): helper routine for above. (This could be much better.)
	(mail_display_init): connect url_requested signal

	* mail-format.c (handle_multipart_related): Make this work.

	* mail-display.c (mail_display_set_message): ref the message we
	display, since we're going to unref it when we remove it. Fixes a
	bug that showed up with the new camel code, but it's not obvious
	if it's due to a bug or a feature in the new code.

2000-04-20  NotZed  <NotZed@HelixCode.com>

	* Makefile.am (evolution_mail_LDADD): Add libibex.la to link.

	* message-list.h: Removed folder summary.

	* message-list.c: Dont include folder-summary anymore.
	(select_msg): Changed to use folder, not summary in
	summary_get_message_info().  God this code is grotty.
	(ml_value_at): Ditto.
	(ml_value_at): Changed to use new interface.  Hmm, this returns a
	static variable, that seems wrong.
	(message_list_set_folder): Remove folder summary.
	(ml_row_count): Oops, remove some debug i put there.

2000-04-20  Dan Winship  <danw@helixcode.com>

	* mail-display.c: update for bonobo change, and remove a
	now-unused variable.

2000-04-17  Chris Toshok  <toshok@helixcode.com>

	* message-list.c (on_row_selection_idle): new function, actually
	calls select_msg.
	(on_row_selection_cmd): register an idle instead of calling
	select_msg directly.  this fixes the lag before the row is
	selected - selection is instantaneous now, with message loading
	happening afterward.

	* message-list.h: add row_to_select and an idle_id to the message
	list to make the select_msg call happen in an idle func.

	* message-list.c (message_list_init_renderers): no more
	e_cell_set_editable.  this info always comes from the model.

2000-04-14  Dan Winship  <danw@helixcode.com>

	* mail-format.[ch]: Moved from camel/camel-formatter, and changed
	slightly. (More to come.)

	* html-stream.[ch]: No longer necessary. mail-format uses
	GtkHTMLStreamHandles directly.

	* mail-display.[ch]: update for new message formatting code.

2000-04-14  Chris Toshok  <toshok@helixcode.com>

	* folder-browser-factory.c (control_activate): use
	gnome_app_fill_toolbar_with_data, so we get the beautiful gnome
	toolbar.

2000-04-14  Dan Winship  <danw@helixcode.com>

	* folder-browser-factory.c (development_warning): Fix up the
	warning message a bit.
	(folder_browser_factory): Make the warning bypassable.

2000-04-12  Miguel de Icaza  <miguel@gnu.org>

	* main.c (main): Call e_cursors_init.

2000-04-10  Dan Winship  <danw@helixcode.com>

	* mail-ops.c (fetch_mail): use camel_movemail when fetching mail
	from an mbox store. This leaves behind temp files for now,
	because CamelMboxFolder::delete is too confused to use, and NotZed
	is rewriting CamelMboxFolder, so I'm not going to bother to try to
	fix it.

	* mail-ops.c: Add some #includes for the non-HAVE_MKSTEMP case

2000-04-09  Matt Loper  <matt@helixcode.com>

	* folder-browser.c (folder_browser_new): set folder_browser->uri
	to NULL, so that we know when to free it.

2000-04-07  Miguel de Icaza  <miguel@gnu.org>

	* message-list.c (states_pixmaps): Add more beautiful art from
	Miggue, the Diego Rivera of the next millenium.
	(message_list_init_header): Use the beautiful art.

	* pixmaps: Miguel rediscovers the "transparent" concept.

2000-04-07  Matt Loper  <matt@helixcode.com>

	* folder-browser.c (folder_browser_destroy): Unref the shell
	interface that we have a handle to.

	* folder-browser-factory.c (control_destroy_cb): New function;
	destroys a folder-browser when its control is destroyed.
	(folder_browser_factory): Hook up to the above.

2000-04-07  Dan Winship  <danw@helixcode.com>

	* mail-ops.c: new file, for toolbar/menu callbacks
	(fetch_mail): fetch mail. Doesn't do mbox locking. Many kludges.

	* folder-browser-factory.c (control_activate): use new fetch_mail
	function as the callback for the "New mail" icon. Rename check_cb
	to random_cb.

	* Makefile.am: don't build test-sources since the version in
	CVS doesn't do much and once I've fixed it it won't be a separate
	program. Add mail-ops.[ch].

2000-04-06  Miguel de Icaza  <miguel@gnu.org>

	* message-list.c: Stick pixmaps here.

	* mail-display.c (embeddable_destroy_cb): Replaced C++ comments
	with C comments.

	* message-list.c (load_internal_images): New function, loads images.
	(message_list_init_renderers): Load images, fix previous attempt
	at loading images. 

	* Makefile.am (dist-hook): Added distribution of pixmaps.

	* pixmaps: New directory, used to hold the XPMs we ship with. 

	* pixmaps/envelope-closed.xpm, pixmaps/envelope-open.xpm: Tigert's
	envelopes incorporated.

2000-03-31  Miguel de Icaza  <miguel@gnu.org>

	* message-list.c (ml_value_at): Fix miss-used variable. 

2000-04-01  Michael Meeks  <michael@helixcode.com>

	* folder-browser.c (folder_browser_properties_init): update to
	new property  (folder_browser_property_changed): kill.
	(get_prop, set_prop): do the donkey work + make properly RW.

2000-03-31  Dan Winship  <danw@helixcode.com>

	* folder-browser-factory.c (folder_browser_set_shell):
	* folder-browser.c (folder_browser_new):
	* message-list.c (on_row_selection_cmd, select_msg,
	message_list_init, message_list_set_folder):

	remove debugging printf()s that no longer seem useful

2000-03-29  Dan Winship  <danw@helixcode.com>

	* folder-browser-factory.c (control_activate): build a toolbar.
	(control_deactivate): and hide it.

2000-03-27  Chris Toshok <toshok@helixcode.com>
	* mail-display.c: quiet warnings when building in ../po

2000-03-26  Miguel de Icaza  <miguel@gnu.org>

	* folder-browser-factory.c (folder_browser_set_shell): Memory leak
	fix. 

2000-03-25  Dan Winship  <danw@helixcode.com>

	* message-list.c (select_msg, ml_value_at): update for summary
	changes. Hey, neat, it really does make it more efficient.

2000-03-22  Christopher James Lahey  <clahey@helixcode.com>

	* .cvsignore: Updated .cvsignore.

2000-03-21  Matt Loper  <matt@helixcode.com>

	* mail-display.c: Minor cleanup & commenting.

	* folder-browser-factory.c: Minor cleanup & warning elimination.

2000-03-21  bertrand  <bertrand@helixcode.com>

	* message-list.c (ml_value_at): display message size

2000-03-20  Christopher James Lahey  <clahey@helixcode.com>

	* message-list.c: Properly ref & sink the table and header models.

2000-03-14  Dan Winship  <danw@helixcode.com>

	* mail-sources.c: First cut at a mail source selection wizard.
	Basically a rigged demo at this point. Doesn't use camel to get
	its information, and is not yet complete or integrated with the
	mail component. Did I mention that the code is ugly?

2000-03-13  bertrand  <bertrand@helixcode.com>

	* folder-browser-factory.c (folder_browser_set_shell): 
	for testing and demonstration purpose, immediately 
	register a fake service.

2000-03-12  bertrand  <bertrand@helixcode.com>

	* folder-browser-factory.c (folder_browser_factory_init): 
	name change.
	(control_activate_cb): when the control is activated, 
	it merges its own UI with the remote UIHandler.
	(control_add_menu): sample menu merging.
	(folder_browser_factory): connect the control "activate" signal.

	* evolution-mail.gnorba: 
	name changes

	* folder-browser.h: added a reference to an 
	Evolution::Shell object. 

	* folder-browser-factory.c (folder_browser_set_shell): 
	(folder_browser_control_add_service_repository_interface): 
	(folder_browser_factory): the folder-browser control now
	implements the Evolution/ServiceRepository interface.

2000-03-07  bertrand  <bertrand@helixcode.com>

	* folder-browser-factory.c (development_warning): 
	added a warning so that the user knows that this 
	version may crash his mails.

2000-03-05  bertrand  <bertrand@helixcode.com>

	* message-list.h: include a referrence to the parent 
	folder browser.

	* message-list.c (ml_value_at): use the message summary 
	from the 

	* html-stream.c (html_stream_close): when the stream 
	is closed, set the html stream to NULL
	(html_stream_write): don't write anything if the 
	html handle does not exist. 
	(html_stream_reset): implemented. close the current 
	html handle and begins a new html parser. 

	* session.c (session_store_new): use static exception
	here. 

2000-03-05  Christopher James Lahey  <clahey@helixcode.com>

	* message-list.c: Added a prototype message listing.

2000-03-04  Christopher James Lahey  <clahey@helixcode.com>

	* message-list.c: Set up the column headers properly.

	* folder-browser.c: Show the folder_browser widget.

2000-03-04  Christopher James Lahey  <clahey@helixcode.com>

	* message-list.c: Define ml_duplicate_value and ml_free_value
	correctly.
	
2000-03-04  Christopher James Lahey  <clahey@helixcode.com>

	* message-list.c: Use g_int_compare and g_str_compare as we should
	be instead of g_int_equal and g_str_equal.
	
2000-03-04  bertrand  <bertrand@helixcode.com>

	* test-mail.c (main): replace the bonobo-active/gtk-main
	by bonobo-main.
	Include Gnorba headers.
	(main): don't call the container creation routine 
	before we entered the main loop. Use idle for that.

2000-03-04  Christopher James Lahey  <clahey@helixcode.com>

	* message-list.c: Change this to use the ETable widget itself
	instead of building it from all the parts.

2000-03-03  Christopher James Lahey  <clahey@helixcode.com>

	* message-list.c: Ref the table columns since we unref them at the
	end.

2000-03-01  Ettore Perazzoli  <ettore@helixcode.com>

	* Makefile.am (INCLUDES): Add `$(top_srcdir)'.  Also, the
	`top_srcdir' includes must come first everything else to avoid
	including installed headers instead of our fresh ones.

2000-02-28  NotZed  <NotZed@HelixCode.com>

	* Makefile.am (evolution_mail_LDADD): Fixed references to eutil.

2000-02-24  Christopher James Lahey  <clahey@helixcode.com>

	* message-list.c: Changed to match new e_table_simple interface.

2000-02-24  Dan Winship  <danw@helixcode.com>

	* message-list.c (message_list_set_folder): update for CamelFolder
	changes

2000-02-24  Christopher James Lahey  <clahey@helixcode.com>

	* message-list.c: Changed this to not use the "x" and "y"
	arguments to e-table-item.

2000-02-23  Matt Loper  <matt@helixcode.com>

	* message-list.c (message_list_set_folder): Check 'desc'riptions
	of exceptions.

2000-02-22  bertrand  <Bertrand.Guiheneuf@aful.org>

	* message-list.c (message_list_set_folder): 
	fix to show a sample correct implementation. 

2000-02-21  Matt Loper  <matt@helixcode.com>

	* Makefile.am: added -lunicode to evolution_mail_LDADD.

2000-02-21  Dan Winship  <danw@helixcode.com>

	* session.c (session_store_new): Pass a CamelAuthCallback
	(evolution_auth_callback) to camel_session_new.
	
2000-02-21  Dan Winship  <danw@helixcode.com>

	* session.c (session_store_new): Update session_store_new to
	deal with the fact that camel_session_get_store takes a
	CamelException now. Doesn't actually do anything with the
	exception yet, because nothing else does yet either.

2000-02-19  Matt Loper  <matt@helixcode.com>

	* .cvsignore: added test-mail.

2000-02-14  Miguel de Icaza  <miguel@gnu.org>

	* folder-browser.c (folder_browser_load_folder): New routine,
	loads a camel folder.
	(folder_browser_set_uri): redo.

	* session.c: new file.  Implements SessionStores to keep track of
	a Session/Store tuple.  

2000-02-13  Matt Loper  <matt@helixcode.com>

	* html-stream.c (html_stream_new): Second param of gtk_html_begin
	should be "", not NULL.
	(html_stream_new): gtk_html_parse() is deprecated, so the call was
	removed.

	* html-stream.h: HTMLStreamClass's parent changed to
	CamelStreamClass, not CamelStream.

2000-02-11  Christopher James Lahey  <clahey@helixcode.com>

	* Makefile.am: Add the e-text directory to the includes list.

	* message-list.c: Change the call to e_cell_text_new, since
	there's an added argument.

2000-02-09  Christopher James Lahey  <clahey@helixcode.com>

	* Makefile.am: Added libetext as libetable depends on it.

2000-02-08  Iain Holmes  <ih@csd.abdn.ac.uk>

	* Makefile.am: Changed the order of the compilation so the CORBA stuff
	was made before it was needed.

2000-01-19  Miguel de Icaza  <miguel@gnu.org>

	* Started work on the mail display engine.

	* html-stream.c, html-stream.h: New files, they are CamelStreams
	used to write to the GtkHTML widget. 

