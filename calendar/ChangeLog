2003-07-23  Dan Winship  <danw@ximian.com>

	* gui/alarm-notify/alarm-queue.c (on_dialog_obj_updated_cb): Fix
	an unused variable

	* gui/calendar-commands.c (purge_cmd): Fix warnings.

	* gui/calendar-config.h: s/confirm_expunge/confirm_purge/ to match
	the actual functions

	* gui/control-factory.c: add some missing #includes

	* gui/dialogs/delete-comp.c (delete_component_dialog): Fix a
	warning

	* gui/e-itip-control.c (write_label_piece): Remove unused variable.

	* gui/print.c (print_calendar): Remove unused variable
	(print_comp): Likewise.

	* gui/tasks-control.c (confirm_purge): Fix warnings.
	(print_tasks): Remove unused variable.

2003-07-23  Rodrigo Moya <rodrigo@ximian.com>

	* gui/e-day-view.h:
	* gui/e-week-view.h: removed unneeded prototypes.

	* gui/e-cal-view.[ch] (e_cal_view_get_visible_time_range): new
	function.
	(selection_received): deal correctly with the selected time range.

	* gui/e-week-view.c (e_week_view_get_visible_time_range): made it
	private as the implementation of the 'get_visible_time_range'
	virtual method.

	* gui/e-day-view.c (e_day_view_get_visible_time_range): ditto.

	* gui/gnome-cal.c (gnome_calendar_direction): merged redundant 'case'.
	(focus_current_view): removed redundant code.

2003-07-22  Rodrigo Moya <rodrigo@ximian.com>

	* gui/e-day-view.c (e_day_view_get_selected_events):
	* gui/e-week-view.c (e_week_view_get_selected_events): manage the
	case where the selected events are the popup menu ones.

2003-07-22  Rodrigo Moya <rodrigo@ximian.com>

	* gui/gnome-cal.c (gnome_calendar_copy_clipboard,
	gnome_calendar_cut_clipboard, gnome_calendar_paste_clipboard):
	removed missing calls to e_day/week_view_*_clipboard.

2003-07-22  Rodrigo Moya <rodrigo@ximian.com>

	* gui/e-cal-view.[ch]: added "get_selected_events",
	and "update_query" virtual methods.
	(e_cal_view_class_init): initialize new virtual methods.
	(e_cal_view_destroy): destroy new private members.
	(e_cal_view_get_selected_events, e_cal_view_set_cal_client,
	 e_cal_view_get_cal_client): new functions.
	(e_cal_view_cut_clipboard, e_cal_view_copy_clipboard,
	 e_cal_view_paste_clipboard): merged clipboard stuff.

	* gui/e-day-view.c (e_day_view_cut_clipboard,
	  e_day_view_copy_clipboard, e_day_view_paste_clipboard): removed.
	(e_day_view_get_selected_events): made these private as the
	implementation of the 'get_selected_events' base class virtual method.

	* gui/e-week-view.c (e_week_view_get_selected_events): ditto.
	(e_week_view_cut_clipboard, e_week_view_copy_clipboard,
	 e_week_view_paste_clipboard): removed.
	
	* gui/calendar-commands.c (sensitize_calendar_commands): call
	e_cal_view_get_selected_events.

	* gui/gnome-cal.c: removed a lot of redundant code thanks to the
	above changes.

2003-07-21  Rodrigo Moya <rodrigo@ximian.com>

	* gui/e-day-view.[ch]: removed e_day_view_set_calendar prototype.
	(e_day_view_set_status_message): removed.

	* gui/e-week-view.[ch] (e_week_view_set_status_message): removed.

	* gui/e-cal-view.[ch] (e_cal_view_set_status_message): new functions.
	(e_cal_view_destroy): unref activity client.

	* gui/gnome-cal.c: updated to e_*_view/e_cal_view.

2003-07-18  Rodrigo Moya <rodrigo@ximian.com>

	* gui/e-day-view.[ch]:
	* gui/e-week-view.[ch]: moved duplicated code to...

	* gui/e-cal-view.[ch]: ...here.
	(e_cal_view_get_calendar, e_cal_view_set_calendar): new functions.

	* gui/e-week-view-event-item.c (e_week_event_item_double_click):
	* gui/gnome-cal.c (setup_widgets): adapted to changes in views.

2003-07-17  Rodrigo Moya <rodrigo@ximian.com>

	* gui/e-cal-view.[ch]: new base class for calendar views.

	* gui/e-day-view.[ch]:
	* gui/e-week-view.[ch]: base these classes on ECalView.

	* gui/Makefile.am: added new files.

2003-07-17  Rodrigo Moya <rodrigo@ximian.com>

	* gui/calendar-config.[ch]:
	* gui/tasks-control.c: s/expunge/purge.

2003-07-16  Rodrigo Moya <rodrigo@ximian.com>

	* gui/gnome-cal.[ch] (gnome_calendar_purge): new function,
	which uses a CalQuery to retrieve the objects older than a given date.
	(check_instance_cb): callback for cal_recur_generate_instances.
	(purging_obj_updated_cb): call check_instance_cb on each recurrence
	to double-check the event can be deleted.
	(purging_query_done_cb, purging_eval_error_cb): needed callbacks to
	finish the query.
	(gnome_calendar_destroy): free new members.

	* gui/calendar-commands.c (purge_cmd): added implementation for the
	'Purge' menu item.

2003-07-16  Andrew Wu <Yang.Wu@sun.com>

      Fixes #45774

      * gui/e-day-view.c (e_day_view_goto_start_of_work_day):
      implemented select the time that begins a work day.
      (e_day_view_goto_end_of_work_day):
      implemented select the time that ends a work day.

2003-07-16  Andrew Wu <Yang.Wu@sun.com>
	
	Fixes #45772
	
	* gui/gnome-cal.c(gnome_calendar_goto_date): implemented Alt+Left/Right
	  to go to the same day of the previous/next week.
	* gui/gnome-cal.h:add two element in GnomeCalendarGotoDateType.

2003-07-14  Rodrigo Moya <rodrigo@ximian.com>

	Fixes #41676

	* gui/dialogs/alarm-options.c (palarm_options_changed_cb,
	  repeat_spin_button_changed_cb, repeat_unit_changed_cb): new callbacks for
	managing modifications in the 'Run a program' alarm case.
	(repeat_toggle_toggled_cb): if the alarm being edited has a procedure
	action, call palarm_options_changed_cb.
	(init_widgets): connect new callbacks.
	(alarm_to_dialog): disable 'OK' button if a procedure alarm.

2003-07-11  Federico Mena Quintero  <federico@ximian.com>

	* gui/dialogs/task-details-page.glade: Changed the "URL:" label to
	"_Web Page:".  Added a widget name to the URL label so that we can
	hook up its mnemonic by hand.  Added underlines to the "%
	Complete:" and "Date Completed:" labels.  Added a widget name to
	the date completed label, also so that we can hook up its mnemonic.

	* gui/dialogs/task-details-page.c (get_widgets): Get the url_label
	and date_completed_label as well.
	(init_widgets): Set the mnemonic widgets of the url_label and the
	date_completed_label by hand, as their respective widgets are
	not created by libglade.

	* gui/e-calendar-table.c (tasks_popup_menu): Added an item for
	"Open Web Page".
	(e_calendar_table_show_popup_menu): Disable the aforementioned
	menu item if the selected task doesn't have the URL property set.
	(open_url_cb): New callback.

	* gui/e-tasks.c (write_html): Make the HTML say "Web Page:"
	instead of "URL:".

2003-07-10  Harry Lu <harry.lu@sun.com>

	Fixes #46075.

	* gui/e-date-time-list.c (compare_datetime): new function to compare
	two CalComponentDateTime instances.
	(e_date_time_list_append): check whether the date already exists
	before adding it to the list.

2003-07-07  Rodrigo Moya <rodrigo@ximian.com>

	Fixes #45910

	* gui/dialogs/task-editor.c (task_editor_class_init): set up the
	handler for the set_cal_client virtual method.
	(task_editor_set_cal_client): added missing virtual method.

2003-07-07  Jack Jia <jack.jia@sun.com>

	* cal-client/cal-client.c (cal_client_get_static_capability): add
	g_return_val_if_fail to check the input param.

2003-07-03  Rodrigo Moya <rodrigo@ximian.com>

	* gui/e-tasks.c (setup_widgets): added a paned widget to contain
	the task list and a HTML widget for displaying the task's details.
	Connect to "cursor_change" signal on the ETable.
	(table_cursor_change_cb): update the HTML view every time the selected
	task changes.
	(timet_to_str_with_zone): new function copied from alarm daemon.
	(url_requested_cb): callback for "url_requested" signal on the
	GtkHTML widget.
	(on_link_clicked_cb): respond to clicks linked on the HTML widget.
	(vpaned_resized_cb): set the configuration entry for the task vpane
	position.
	(e_tasks_destroy): free new member.
	(e_tasks_construct): connect to "obj_removed" signal on the CalClient.
	(client_obj_removed_cb): if the updated object is the one being
	displayed in the HTML widget, update it.

	* gui/calendar-config.[ch] (calendar_config_get_task_vpane_pos):
	(calendar_config_gset_task_vpane_pos): new functions.

	* gui/apps_evolution_calendar.schemas: added task vpane position.

2003-07-03  Antonio Xu <antonio.xu@sun.com>

	Fixes #45767
	
	* conduits/todo/Makefile.am: removed libwombat from the build.

2003-07-02  Harry Lu <harry.lu@sun.com>

 	Fixes #44485

 	* gui/e-timezone-entry.c (e_timezone_entry_set_entry): pass a 
 	new allocated string to gtk_entry_set_text instead of the one
 	that might come from gettext.

2003-07-02  Dan Winship  <danw@ximian.com>

	* cal-client/cal-client.c (real_open_calendar): Don't leak
	exceptions
	(load_static_capabilities): free the capability string

	* gui/dialogs/task-page.c (task_page_fill_component): Free the
	description text if it *was* set, rather than if it wasn't.

	* gui/dialogs/task-editor.c (task_editor_finalize): Free the priv
	struct.

2003-07-02  Bolian Yin <bolian.yin@sun.com>

	Fixes #45328, #45329

	* gui/e-day-view.c (e_day_view_do_key_press): Do not process
	PageUp/PageDown, .. when the Alt key is pressed (give key binding
	set the chance).
	* gui/gnome-cal.h : define new enum type, GNOME_CAL_GOTO_DATE_TYPE.
	* gui/gnome-cal.c (gnome_calendar_class_init): define new signal
	 "goto_date".  Add key bindings for "Alt+PageUp/PageDown",
	 "Alt+Home/End".
	(gnome_calendar_goto_date): Impl. signal handler for "goto_date".

2003-07-01  Rodrigo Moya <rodrigo@ximian.com>

	Fixes #45524

	* gui/calendar-commands.c: use stock icons where approppriate.

	* gui/tasks-control.c: removed EPixmaps structure, since we only use
	stock icons now.
	(tasks_control_activate): no need to call e_pixmaps_update.

2003-07-01  Bolian Yin <bolian.yin@sun.com>

	Fixes #45274

	* gui/e-week-view.c: implemented tabbing though events in week view.

2003-06-30  Rodrigo Moya <rodrigo@ximian.com>

	* cal-client/cal-client.c: removed usage of WombatClient.
	(client_get_password_cb, client_forget_password_cb): removed.
	(real_open_calendar): don't create the WombatClient object.
	(cal_client_init, cal_client_finalize): removed WombatClient
	related code.
	(cal_client_finalize): re-enabled call to destroy_factories.

	* pcs/cal.c: removed usage of WombatClient interface.
	(cal_construct): don't get a reference to the WombatClient.
	(cal_get_password, cal_forget_password): removed unused functions.

	* conduits/calendar/Makefile.am:
	* cal-client/Makefile.am: removed references to libwombat.

2003-06-27  Rodrigo Moya <rodrigo@ximian.com>

	* gui/dialogs/send-comp.[ch] (send_component_dialog):
	* gui/dialogs/cancel-comp.[ch] (cancel_component_dialog): added a
	GtkWindow argument for callers to specify the parent window.

	* gui/dialogs/changed-comp.[ch] (changed_component_dialog): added
	'parent' argument and use GtkMessageDialog instead of
	gnome_question_dialog.

	* gui/e-calendar-table.c (e_calendar_table_delete_selected):
	* gui/e-day-view.c (e_day_view_delete_event_internal,
	  e_day_view_on_cut, e_day_view_finish_long_event_resize,
	  e_day_view_finish_resize, e_day_view_on_editting_stopped,
	  e_day_view_on_top_canvas_drag_data_received, selection_received):
	* gui/e-week-view.c (e_week_view_delete_event_internal,
	  e_week_view_on_cut, e_week_view_on_editing_stopped,
	  selection_received):
	* gui/dialogs/event-editor.c (cancel_meeting_cmd):
	* gui/dialogs/task-editor.c (cancel_task_cmd):
	* gui/dialogs/comp-editor.c (delete_cmd, obj_removed_cb): pass the parent window to
	the *_component_dialog() functions.

	* gui/dialogs/delete-comp.c (delete_component_dialog): use the 'widget'
	argument to get the parent window for the dialog.

2003-06-26  Bolian Yin <bolian.yin@sun.com>

	Fixes #45276

	* gui/e-day-view.c (e_day_view_on_text_item_event): set focus to dayview
	when editing is canceled.
	* gui/e-week-view.c (e_week_view_on_text_item_event): set focus to weekview
	when editing is canceled

2003-06-25  Rodrigo Moya <rodrigo@ximian.com>

	Fixes #44723

	* gui/dialogs/alarm-page.c: added a new field to the private structure
	to keep track of the old summary.
	(alarm_page_init): initialize new field.
	(alarm_page_finalize): free new field.
	(alarm_page_set_summary): iterate over the list of alarms to change
	their description if it was the same as the event's summary.

2003-06-25  Rodrigo Moya <rodrigo@ximian.com>

	Fixes #44719

	* gui/alarm-notify/alarm-notify-dialog.c (alarm_notify_dialog): use
	gtk_window_set_icon_from_file to set the window's icon and implemented
	the code to make the window sticky with GTK 2.x API.
	
2003-06-25  Bolian Yin <bolian.yin@sun.com>

	Fixes #45275

	* gui/e-calendar-table.c (e_calendar_table_show_popup_menu): new function.
	(e_calendar_table_on_right_click_menu): call e_calendar_table_show_popup_menu.
	(e_calendar_table_on_popup_menu): callback for "popup_menu" signal.
	(e_calendar_table_init): connect to ETable's "popup_menu" signal.

2003-06-25  Bolian Yin <bolian.yin@sun.com>

	Fixes #45273

	* gui/e-day-view.c: implemented tabbing though events in day view.
	
2003-06-23  Rodrigo Moya <rodrigo@ximian.com>

	* gui/dialogs/comp-editor.c (make_title_from_string, set_title_from_string):
	new functions.
	(page_summary_changed_cb): change the window title when the object's
	summary changes.

2003-06-22  Rodrigo Moya <rodrigo@ximian.com>

	* cal-client/cal-client.c (get_factories): don't use a static GList,
	since the value returned is freed in destroy_factories, making several
	clients use a buggy GList if one of them happen to be destroyed.

2003-06-22  Hans Petter Jansson  <hpj@ximian.com>

	* gui/print.c (get_font_for_size): Remove debug output.

	* gui/tasks-control.c (print_tasks): Ref and sink the printable.
	Use fixed (5%) margins instead of what gnome-print gives us.

2003-06-19  Dan Winship  <danw@ximian.com>

	* pcs/cal-backend.c (cal_backend_finalize): don't leak the
	CalBackendPrivate.

2003-06-18  Dan Winship  <danw@ximian.com>

	* gui/calendar-config.c (calendar_config_get_hpane_pos) 
	(calendar_config_get_vpane_pos) 
	(calendar_config_get_month_hpane_pos) 
	(calendar_config_get_month_vpane_pos): Plug in the defaults from
	the schemas file here, so that even if something goes wrong with
	the schemas, people will still get reasonable defaults instead of
	"I click on the calendar and it shows me tasks".

2003-06-16  Rodrigo Moya <rodrigo@ximian.com>

	* gui/dialogs/comp-editor.c (make_title_from_comp): removed unused
	variable.

2003-06-12  Jack Jia <jack.jia@sun.com>
 
 	* gui/e-itip-control.c
 	(struct _EItipControlPrivate): switch the "view_only" arg to be an
	int.
 	(init): ditto.
 	(e_itip_control_set_view_only): ditto.
 	(e_itip_control_get_view_only): ditto.
 
 	* gui/itip-bonobo-control.c
 	(get_prop): switch BONOBO_ARG_SET_BOOLEAN to BONOBO_ARG_SET_INT.
 	(set_prop): switch BONOBO_ARG_GET_BOOLEAN to BONOBO_ARG_GET_INT.
 	(itip_bonobo_control_new): switch BONOBO_ARG_BOOLEAN to
	BONOBO_ARG_INT.
 
 	Function "bonobo_property_bag_client_set_value_gboolean" can not
	work on solaris.

2003-06-10  Bolian Yin <bolian.yin@sun.com>

	Fixes #44682, Shift+F10 to active popup menu on day/week view

	* gui/e-day-view.c (e_day_view_key_press, e_day_view_do_key_press):
	  When the key press is not handled, give keybindings the chance.
	 (e_day_view_popup_menu, e_day_view_show_popup_menu,
	 e_day_view_on_event_right_click ): popup menu will be activated from
	 both keyboard and mouse.

	* gui/e-week-view.c (e_week_view_key_press, e_week_view_do_key_press):
          When the key press is not handled, give keybindings the chance.
	 (e_week_view_popup_menu): popup menu can be activated from keyboard

2003-06-10  Rodrigo Moya <rodrigo@ximian.com>

	Fixes #41582

	* gui/gnome-cal.c (gnome_calendar_hpane_resized): killed warnings
	and added code to resize the EDayView's time column on the hpane's
	resizing.
	(gnome_calendar_vpane_resized): killed warnings.
	
2003-06-05  Not Zed  <NotZed@Ximian.com>

	** For #42691.

	* gui/Makefile.am (%.server.in): implicit rule for .in file.
	(BUILT_SOURCES): added server_DATA.

	* gui/alarm-notify/Makefile.am (%.server.in): added implicit rule
	for .in file.
	(BUILT_SOURCES): added server_DATA.

2003-06-04  Rodrigo Moya <rodrigo@ximian.com>

	* pcs/query.c (start_cached_query_cb): adapted to changes in
	EComponentListener API.
	(query_construct): ditto.

	* cal-client/cal-client.c (cal_opened_cb): ditto.
