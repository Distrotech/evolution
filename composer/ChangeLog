2000-08-10  Peter Williams  <peterw@helixcode.com>

	* e-msg-composer.c (do_exit): Temporarily disable draft saving
	while we figure out how to work around Zucchi's new append_message.

2000-08-10  Jeffrey Stedfast  <fejj@helixcode.com>

	* e-msg-composer-hdrs.c (e_msg_composer_hdrs_get_from): Return the
	text in GtkCombo->entry

2000-08-09  Jeffrey Stedfast  <fejj@helixcode.com>

	* e-msg-composer-hdrs.c (create_dropdown_entry): Fixed the GList
	identity stuff, should now display all configured identities.

2000-08-09  Christopher James Lahey  <clahey@helixcode.com>

	* e-msg-composer-address-dialog.c: Fixed some warnings.

	* e-msg-composer-hdrs.c: Switched the composer to use an EEntry
	for the subject field.

	* e-msg-composer.c: Changed the non scaling objects in this vbox
	to be FALSE, FALSE instead of FALSE, TRUE.

2000-08-09  Jeffrey Stedfast  <fejj@helixcode.com>

	* e-msg-composer-hdrs.c (add_header): Modified to allow dropdown
	entry-boxes as well (for headers like From:)
	(setup_headers): Modified to use the correct enum type.
	(create_dropdown_entry): New convenience function to add a
	drop-down combo box and fill it in with identities
	(init): Set from_entry to NULL
	(e_msg_composer_hdrs_get_from): New convenience function to get
	the text in the From widget in the composer
	(e_msg_composer_hdrs_set_from): New convenience function to set
	the From header in the composer

2000-08-08  JP Rosevear  <jpr@helixcode.com>

	* Makefile.am: Fix build by allowing includes for e-table dir

2000-08-07  Jeffrey Stedfast  <fejj@helixcode.com>

	* e-msg-composer-attachment-bar.c (attach_to_multipart):
	s/strcasecmp/g_strcasecmp

	* e-msg-composer.c: s/strncasecmp/g_strncasecmp - this will help
	later with building on different platforms :-)

2000-08-07  Jeffrey Stedfast  <fejj@helixcode.com>

	* e-msg-composer.c (e_msg_composer_new_with_message): Added code
	to set the body text based on the CamelMimeMessage.
	(set_editor_text): Use lowercase html tags...

2000-08-07  Jeffrey Stedfast  <fejj@helixcode.com>

	* e-msg-composer.c (do_exit): Prompt the user to save their
	composition in Drafts.
	(set_editor_text): Uhm, use "-- \n" not "--\n" because the space
	is called for in the standard
	(e_msg_composer_new_with_message): New convenience function that
	takes a CamelMimeMessage as an argument. This will be useful when
	we code the ability to resume the editing of a message draft (like
	in the Drafts folder).

2000-08-01  JP Rosevear  <jpr@helixcode.com>

	* e-msg-composer.h: Constify param

	* e-msg-composer.c (get_signature): Constify param
	(set_editor_text): ditto
	(e_msg_composer_new_with_sig_file): ditto

2000-08-01  Peter Williams  <peterw@helixcode.com>

	* e-msg-composer.c (set_editor_text): sizeof("--\") !=
	strlen("--\n"), breaking the test for the signature prefix.

2000-07-28  JP Rosevear  <jpr@helixcode.com>

	* e-msg-composer.c (e_msg_composer_new_with_sig_file): New
	function to create composer with sig file set.
	(e_msg_composer_get_sig_file): New function to get sig file
	(e_msg_composer_set_sig_file): New function to set sig file

2000-07-25  Michael Meeks  <michael@helixcode.com>

	* e-msg-composer.c (get_text): add textual exception printout.
	(set_editor_text): close pre tags & check for pre-existing
	sig separator.

2000-07-25  Peter Williams  <peterw@helixcode.com>

	* e-msg-composer.c (menu_file_insert_file_cb): Mark this function
	as FIXME because we're waiting for the HTML Editor Control to
	support paste commands. Also some updates for when that happens.

2000-07-24  Dan Winship  <danw@helixcode.com>

	* e-msg-composer.c: Remove GOAD support.
	(create_editor): Try to give a more helpful error message when
	failing to load the editor control.

2000-07-23  Ettore Perazzoli  <ettore@helixcode.com>

	* e-msg-composer.c (menu_format_html_cb): New callback for the
	"Send HTML" menu toggle item.
	(create_menubar_format): New.
	(create_menubar): Call it.
	(create_menubar_options): Removed.
	(init): Initialize `send_html' and `attachment_bar_visible' to
	FALSE.
	(get_signature): Add `void' to the declaration.  This is C, not
	C++.
	(menu_file_close_cb): Renamed from `exit_cb'.
	(menu_file_send_cb): Renamed from `send_cb'.
	(menu_file_save_as_cb): Renamed from `save_as_cb'.
	(menu_file_save_cb): Renamed from `save_cb'.
	(menu_file_open_cb): Renamed from `open_cb'.
	(menu_file_add_attachment_cb): Renamed from `add_attachment_cb'.
	(menu_file_insert_file_cb): Renamed from `insert_file_cb'.
	(e_msg_composer_set_send_html): New.
	(build_message): Use the `send_html' flag instead of peeking the
	`msg_format' gnome-config value directly.

	* e-msg-composer.h: New member `send_html' in `EMsgComposer'.

2000-07-23  Ettore Perazzoli  <ettore@helixcode.com>

	* e-msg-composer.c: Changed to use BonoboUIHandler stuff directly
	instead of translating from GnomeUIInfo.
	(create_menubar_file): New.
	(create_menubar_edit): New.
	(create_menubar_view): New.
	(create_menubar_options): New.
	(create_menubar): Use these functions to set up the menu bar.
	(create_toolbar): Use BonoboUIHandler directly instead of
	converting from GnomeUIInfo.
	(toolbar_view_attachments_clicked_cb): Removed.
	(address_dialog_cb): Removed.
	(address_dialog_destroy_cb): Removed.
	(address_dialog_apply_cb): Removed.
	(setup_address_dialog): Removed.

2000-07-12  Peter Williams  <peterw@helixcode.com>

	* e-msg-composer.c: (view_tree) Make the "View Attachments" item
	a toggleitem ... so that it can be toggled...
	(menu_view_attachments_activate_cb): Treat the widget correctly
	and toggle correctly.

2000-07-10  Ettore Perazzoli  <ettore@helixcode.com>

	* e-msg-composer.c (exit_cb): Use it.
	(delete_event): New, handler for the "delete_event" signal.

2000-07-09  Dan Winship  <danw@helixcode.com>

	* e-msg-composer.c (set_editor_text): Don't load "" into the
	editor, because it will cause the editor component to g_warning.

2000-07-09  Christopher James Lahey  <clahey@helixcode.com>

	* e-msg-composer-hdrs.c: Removed the extra frame here.

2000-07-08  Dan Winship  <danw@helixcode.com>

	* e-msg-composer.c (create_menubar): Create an empty "Edit" menu
	for the editor control to insert itself into.

2000-07-08  Jeffrey Stedfast  <fejj@helixcode.com>

	* .cvsignore: Ignore dynamically created source files

2000-07-08  Ettore Perazzoli  <ettore@helixcode.com>

	* e-msg-composer-hdrs.c (set_entry): New.
	(e_msg_composer_hdrs_set_to): Use it.
	(e_msg_composer_hdrs_set_cc): Likewise
	(e_msg_composer_hdrs_set_bcc): Likewise.
	(e_msg_composer_hdrs_get_to): Replace implementation with a
	`g_assert_not_reached()'.
	(e_msg_composer_hdrs_get_cc): Likewise.
	(e_msg_composer_hdrs_get_bcc): Likewise.

	* e-msg-composer.c: Get rid of cut/copy/paste/undo as they
	duplicate the editor toolbar and cannot be made to work for all
	the widgets anyway.

2000-07-08  Ettore Perazzoli  <ettore@helixcode.com>

	* e-msg-composer-hdrs.c: New member `corba_select_names' in
	`EMsgComposerHdrsPrivate'.
	(destroy): If not `CORBA_OBJECT_NIL', release.
	(init): Init to `CORBA_OBJECT_NIL'.
	(setup_corba): New.
	(e_msg_composer_hdrs_new): Call it.
	(add_entry): Create the entries by using the ::SelectNames
	interface.
	(address_button_clicked_cb): Activate the dialog through the
	::SelectNames interface.

2000-06-29  Jeffrey Stedfast  <fejj@helixcode.com>

	* e-msg-composer.c: Changed "Exit" to "Close" in the File menu.
	This is a little more intuitive as it does not suggest exiting
	the application, just says "close this window".

2000-06-26  Christopher James Lahey  <clahey@helixcode.com>

	* Makefile.am: Added e-msg-composer-select-file.h for make
	distcheck.

2000-06-26  Ettore Perazzoli  <ettore@helixcode.com>

	* e-msg-composer.c
	(load): New.
	(open_cb): Use it.
	(save): New function.
	(save_cb): Implemented by using it.
	(save_as_cb): Likewise.

2000-06-17  Ettore Perazzoli  <ettore@helixcode.com>

	* e-msg-composer.c (e_msg_composer_construct): I18N the title bar.

	* Makefile.am (libcomposerinclude_HEADERS): Removed.  Move all the
	`.h' files into `libcomposer_la_SOURCES' so that they get
	distributed, but not installed.

	* e-msg-composer.c (open_cb): New; implement the `Open' command.
	(save_as_cb): New; implement the `Save as' command.
	(init): Initialize the `persist_file_interface' and
	`persist_stream_interface' members to NULL.
	(destroy): Release the PersistStream and PersistFile interfaces.
	(e_msg_composer_construct): Query the PersistFile and
	PersistStream interfaces on the control and save them in the
	`persist_file_interface' and `persist_stream_interface' members.
	(get_text): Renamed from `get_editor_text'.  Get a
	@persist_stream_interface instead of querying it a the control.
	(build_message): Return NULL if `persist_stream_interface' is nil.

	* e-msg-composer.h: New member `persist_file_interface' in
	`EMsgComposer'.

	* e-msg-composer-select-file.c: New.
	* e-msg-composer-select-file.h: New.

	* e-msg-composer.c (e_msg_composer_construct): Make the `To:'
	entry grab the keyboard focus.

	* e-msg-composer-hdrs.c (e_msg_composer_hdrs_get_to_entry): New.
	(e_msg_composer_hdrs_get_cc_entry): New.
	(e_msg_composer_hdrs_get_bcc_entry): New.
	(e_msg_composer_hdrs_get_subject_entry): New.

	* e-msg-composer.c (e_msg_composer_construct): Set the scroll
	frame's shadow type to `GTK_SHADOW_IN'.
	(format_text): Initialize `tabbing' to zero to shut down the
	compiler.

2000-06-14  Dan Winship  <danw@helixcode.com>

	* e-msg-composer-attachment-bar.c (add_from_user): keep the
	GtkFileSelection around between calls so we start up in the same
	directory we ended up in last time around. (Also fixes a big
	memory leak in that the code was already keeping the
	GtkFileSelection around, it just wasn't remembering to reuse it.)

	* e-msg-composer.c (format_text): Don't line-wrap lines that start
	with ">".

2000-06-12  Dan Winship  <danw@helixcode.com>

	* e-msg-composer.c (format_text): If a paragraph starts with TABs,
	indent the whole paragraph to that tab level.

2000-06-12  Ettore Perazzoli  <ettore@helixcode.com>

	* e-msg-composer.c: Make the `attachment_scroll_frame' an
	`EScrollFrame'.
	(exit_cb): I18N the quit message.

	* e-msg-composer.h: `attachment_scrolled_window' renamed to
	`attachment_scroll_frame'.

2000-06-12  Dan Winship  <danw@helixcode.com>

	* e-msg-composer.c (format_text): Don't break on non-breaking
	spaces, don't keep non-breaking spaces that fall after a line
	wrap, and translate non-breaking spaces to regular ones after
	wrapping.

2000-06-05  Dan Winship  <danw@helixcode.com>

	* e-msg-composer.c (e_msg_composer_attach): New convenience
	function.

	* e-msg-composer-attachment.c: Store a CamelMimePart rather than
	filename/description/mime_type info. Also record whether we were
	told or guessed the MIME type.
	(e_msg_composer_attachment_new_from_mime_part): New constructor.
	(e_msg_composer_attachment_edit): Remove the "browse" button. (If
	the user wants to change the actual file that the attachment is
	based on, he should delete the attachment and create a new one...)
	Remove the "Apply" button, because it's not all that useful. Make
	the MIME type only track the filename if it was guessed rather
	than being provided.

	* e-msg-composer-attachment.glade: Remove "browse" and "apply"
	buttons. Make filename editable.

	* e-msg-composer-attachment-bar.c (sort): Removed. Send the
	attachments in the order the user attached them in.
	(text_changed): Removed, since we weren't enabling the relevant
	GnomeIconList functionality that would have used this.
	(update): Don't print the size if it's 0.
	(attach_to_multipart, etc): adjust for EMsgComposerAttachment
	changes.
	(attach_to_multipart): Use 7bit encoding for message/ subparts.
	(e_msg_composer_attachment_bar_attach_mime_part): New convenience
	function.
	

2000-06-02  Christopher James Lahey  <clahey@helixcode.com>

	* e-msg-composer.c: Added the ability to save plain text mail.

2000-05-29  Dan Winship  <danw@helixcode.com>

	* e-msg-composer.c (get_editor_text): add a "format" argument so
	we can fetch different kinds of text.
	(format_text): New function to do line wrapping on plain text.
	(build_message): Build multipart/alternative messages rather than
	HTML-only ones. Yay. We don't suck (as much) any more!

2000-05-28  Dan Winship  <danw@helixcode.com>

	* e-msg-composer.c: #include <errno.h>

2000-05-26  Dan Winship  <danw@helixcode.com>

	* e-msg-composer.c (get_editor_text, set_editor_text): Update for
	PersistStream changes
	(build_message): Update for CamelMultipart changes.

	* e-msg-composer.c (get_signature): routine to read the user's
	signature file.
	(set_editor_text): If the user has configured a signature, append
	it to the set text.
	(e_msg_composer_new): Call set_editor_text with "" to load the
	signature (if any).
	
2000-05-25  Not Zed  <NotZed@HelixCode.com>

	* e-msg-composer.c (build_message): Use camel_data_wrapper_new
	instead of camel_simple_data_wrapper_new.

2000-05-17  Dan Winship  <danw@helixcode.com>

	* e-msg-composer.c (build_message): Use
	camel_simple_data_wrapper_new rather than camel_data_wrapper_new.

2000-05-13  Valek Filippov  <frob@df.ru>

	* e-msg-composer-attachment.glade: save translatable strings
	* e-msg-composer-attachment.glade.h: file with strings
	* e-msg-composer-address-dialog.glade: save translatable strings
	* e-msg-composer-address-dialog.glade.h: file with strings

2000-05-12  Dan Winship  <danw@helixcode.com>

	* e-msg-composer.c (get_editor_text): NUL-terminate the data
	extracted from the BonoboStream.

2000-05-10  Dan Winship  <danw@helixcode.com>

	* e-msg-composer-attachment-bar.c (attach_to_multipart): deal with
	Content-Transfer-Encoding a little bit at least.

2000-05-07  Mathieu Lacage <mathieu@gnu.org>

	* e-msg-composer.c (create_editor): remove FIXME and hardcoded 
	string. You can write mails with OAF now.
	
2000-05-07  Dan Winship  <danw@helixcode.com>

	* e-msg-composer.c (build_message): unref content, etc. after
	attaching it to message.

	* e-msg-composer-attachment-bar.c (attach_to_multipart): unref
	part after attaching it.

2000-05-06  Christopher James Lahey  <clahey@helixcode.com>

	* e-msg-composer-hdrs.c: Turned off focus in the To, Cc, and Bcc
	buttons.

2000-05-02  Matt Loper  <matt@helixcode.com>

	* Makefile.am: set G_LOG_DOMAIN.

2000-04-28  Dan Winship  <danw@helixcode.com>

	* e-msg-composer-hdrs.c (set_recipients): Update (minimally) for
	Camel recipient changes.

2000-04-27  Dan Winship  <danw@helixcode.com>

	* e-msg-composer.c (e_msg_composer_new_from_url): New routine, to
	process mailto URLs.

2000-04-26  Dan Winship  <danw@helixcode.com>

	* e-msg-composer.c (build_message): Only generate a multipart
	message if there are attachments. Otherwise generate a single
	part.

	* Update for CamelMimeBodyPart -> CamelMimePart

2000-04-26  Dan Winship  <danw@helixcode.com>

	* e-msg-composer-attachment-bar.c (attach_to_multipart): add a
	s/SIMPLE_// that notzed missed. Update to use
	camel_mime_part_set_content.
	* e-msg-composer.c (build_message): remove a now-unused variable.
	Update for camel_mime_part_set_content.

2000-04-26  NotZed  <NotZed@HelixCode.com>

	* e-msg-composer.c (build_message): Use camel_mime_part_set_text()
	to set the text rather than messing with data wrappers.

	* e-msg-composer-attachment-bar.c (attach_to_multipart): Change
	for new camel-stream interfaces.
	(attach_to_multipart): Also set base64 encoding by default.

2000-04-25  Radek Doulik  <rodo@helixcode.com>

	* e-msg-composer.c (create_editor): use uih here
	(e_msg_composer_construct): create menubar/toolbar before creating
	editor control

2000-04-23  Dan Winship  <danw@helixcode.com>

	* Makefile.am: build libcomposer static and don't install it.

	* e-msg-composer-attachment-bar.c (attach_to_multipart): This was
	only half-implemented. Finish it, mostly.

2000-04-22  Dan Winship  <danw@helixcode.com>

	* e-msg-composer.c (e_msg_composer_add_header): new function to
	make the composer record additional headers it should output.
	(In-Reply-To), etc.
	(build_message): output them

2000-04-21  Dan Winship  <danw@helixcode.com>

	* e-msg-composer.c (e_msg_composer_set_headers): 
	(e_msg_composer_set_body_text): new functions
	(exit_cb): Connect "Exit" menu item finally.

	* e-msg-composer-hdrs.c: const poisoning
	(e_msg_composer_hdrs_set_subject): 
	(e_msg_composer_hdrs_get_subject): new functions

	* e-msg-composer-address-entry.c: const poisoning

2000-04-20  Dan Winship  <danw@helixcode.com>

	* e-msg-composer.c (get_editor_text, set_editor_text): new
	functions to get and set the contents of the HTML editor via
	Bonobo::PersistStream.
	(build_message): use get_editor_text. This works again.

2000-04-17  Dan Winship  <danw@helixcode.com>

	* e-msg-composer.c (build_message): Change
	camel_mime_message_new_with_session to camel_mime_message_new

2000-03-17  bertrand  <bertrand@helixcode.com>

	* e-msg-composer.c (create_menubar): Pass the composer as the data
	for the menubar callbacks.

2000-03-12  Matt Loper  <matt@helixcode.com>

	* Makefile.am: Modified to make the composer into a library, to be
	used by the mail component.

2000-03-07  Ettore Perazzoli  <ettore@helixcode.com>

	* e-msg-composer.c (create_toolbar): Pass the composer as the data
	for the toolbar callbacks.
	(e_msg_composer_construct): Connect the "changed" signal of the
	attachment bar to `attachment_bar_changed()'.
	(attachment_bar_changed): Renamed to `attachment_bar_changed_cb'.

2000-03-02  Ettore Perazzoli  <ettore@helixcode.com>

	* e-msg-composer.c (e_msg_composer_new): Precondition:
	gtk_main_level() greater than zero.
	(e_msg_composer_construct): Likewise.
	(create_menus): New function.  Set up menus through
	BonoboUIHandler.
	(e_msg_composer_construct): Use it.

	* main.c (main): Initialize Bonobo.

	* e-msg-composer.c (init): Initialize `uih' and `editor' to NULL.
	Do not init `text' and `text_scrolled_window' anymore.
	(destroy): Unref `uih'.
	(e_msg_composer_construct): Create a new BonoboUIHandler and put
	it into `uih'.
	(create_editor): New helper function.
	(e_msg_composer_construct): Use it to set up the editor.

	* e-msg-composer.h: New member `uih' in `EMsgComposer'.  Removed
	members `text', `text_scrolled_window'.  New member `editor'.

	* Makefile.am (INCLUDES): Add `$(BONOBO_GNOME_CFLAGS)'.
	(evolution_msg_composer_LDADD): Add `$(BONOBO_GNOME_LIBS)'.

	* e-msg-composer.c (glade_connect): Removed.
	(setup_signals): Removed.
	(e_msg_composer_construct): Do not use libglade to set the toolbar
	and menubar up.
	(destroy): Removed libglade stuff.
	(init): Likewise.

	* e-msg-composer.h: Removed `menubar_gui', `toolbar_gui',
	`appbar_gui'.

	* e-msg-composer.glade: Removed.

2000-01-12  bertrand  <bertrand@helixcode.com>

	* Makefile.am (evolution_msg_composer_LDADD): 
	use $(EXTRA_GNOME_LIBS_THREADS) to link with gthread

1999-11-17  Ettore Perazzoli  <ettore@gnu.org>

	* Makefile.am: New Makefile to compile the message composer
	executable.

	* main.c: New file.

	* e-msg-composer-hdrs.c (e_msg_composer_hdrs_to_message): Use
	`CAMEL_RECIPIENT*' macros instead of the old `RECIPIENT*' ones
	that do not exist anymore.

	* e-msg-composer-address-dialog.c
	(e_msg_composer_address_dialog_construct): Use `E_GLADEDIR'
	instead of `E_GUIDIR'.
	* e-msg-composer-attachment.c (e_msg_composer_attachment_edit):
	Likewise.
	* e-msg-composer.c (e_msg_composer_construct): Likewise.

(See `$(top_srcdir)/widgets/ChangeLog' for previous changes to the
message composer.)
