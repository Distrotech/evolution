SUBDIRS	= select-names

INCLUDES =									\
	-DG_LOG_DOMAIN=\"evolution-addressbook\"		\
	-I$(top_srcdir)						\
	-I$(top_builddir)					\
	-I$(top_srcdir)/shell					\
	-I$(top_builddir)/shell					\
	-I$(top_srcdir)/widgets/misc				\
	-I$(top_srcdir)/addressbook/gui/contact-editor		\
	-I$(top_srcdir)/addressbook/gui/contact-list-editor	\
	-I$(top_srcdir)/addressbook/gui/minicard		\
	-I$(top_srcdir)/addressbook/gui/widgets			\
	-I$(top_srcdir)/addressbook/backend			\
	-I$(top_builddir)/addressbook/backend			\
	-DEVOLUTION_DATADIR=\""$(datadir)"\"			\
	-DEVOLUTION_GLADEDIR=\""$(gladedir)"\"			\
	-DEVOLUTION_ETSPECDIR=\""$(etspecdir)"\"		\
	-DEVOLUTION_IMAGESDIR=\""$(imagesdir)"\"		\
	-DEVOLUTION_LOCALEDIR=\""$(localedir)"\"		\
	-DEVOLUTION_UIDIR=\""$(evolutionuidir)"\"		\
	-DPREFIX=\""$(prefix)"\"				\
	$(LDAP_CFLAGS)						\
	-DG_DISABLE_DEPRECATED					\
	-DGTK_DISABLE_DEPRECATED				\
	-DLIBGNOME_DISABLE_DEPRECATED				\
	-DLIBGNOMEUI_DISABLE_DEPRECATED				\
	$(EVOLUTION_ADDRESSBOOK_CFLAGS)

component_LTLIBRARIES = libevolution-addressbook.la

libevolution_addressbook_la_SOURCES = 	\
	addressbook-component.c		\
	addressbook-component.h		\
	addressbook-config.c		\
	addressbook-config.h		\
	addressbook-storage.c		\
	addressbook-storage.h		\
	addressbook.c			\
	addressbook.h			\
	component-factory.c		\
	e-cardlist-model.c		\
	e-cardlist-model.h		\
	e-address-widget.h		\
	e-address-widget.c		\
	e-address-popup.h		\
	e-address-popup.c

libevolution_addressbook_la_LIBADD =							\
	select-names/libeselectnames.la							\
	$(top_builddir)/shell/libeshell.la						\
	$(top_builddir)/addressbook/gui/widgets/libeminicard.la				\
	$(top_builddir)/addressbook/printing/libecontactprint.la			\
	$(top_builddir)/addressbook/gui/search/libeaddressbooksearch.la			\
	$(top_builddir)/filter/libfilter.la						\
	$(top_builddir)/addressbook/backend/ebook/libebook.la				\
	$(top_builddir)/addressbook/gui/contact-list-editor/libecontactlisteditor.la	\
	$(top_builddir)/addressbook/gui/contact-editor/libecontacteditor.la		\
	$(top_builddir)/widgets/misc/libemiscwidgets.la					\
	$(top_builddir)/addressbook/gui/merging/libecardmerging.la			\
	$(top_builddir)/widgets/menus/libmenus.la					\
	$(EVOLUTION_ADDRESSBOOK_LIBS) $(LDAP_LIBS)



libevolution_addressbook_la_LDFLAGS = -module -avoid-version

# GConf schemas

schemadir   = $(GCONF_SCHEMA_FILE_DIR)
schema_DATA = apps_evolution_addressbook.schemas

install-data-local:
	if test -z "$(DESTDIR)" ; then \
		for p in $(schema_DATA) ; do \
			GCONF_CONFIG_SOURCE=$(GCONF_SCHEMA_CONFIG_SOURCE) $(GCONFTOOL) --makefile-install-rule $(srcdir)/$$p; \
		done \
	fi

server_in_files = GNOME_Evolution_Addressbook.server.in.in
server_DATA = $(server_in_files:.server.in.in=.server)
%.server.in: %.server.in.in
	sed -e "s|\@COMPONENTDIR\@|$(componentdir)|" $< > $@

@INTLTOOL_SERVER_RULE@

glade_DATA = ldap-config.glade

BUILT_SOURCES = $(server_DATA)
CLEANFILES    = $(BUILT_SOURCES)

EXTRA_DIST =			\
	$(glade_DATA)		\
	$(schema_DATA)		\
	$(server_DATA)		\
	$(server_in_files)

if ENABLE_PURIFY
PLINK = $(LIBTOOL) --mode=link $(PURIFY) $(CCLD) $(AM_CFLAGS) $(CFLAGS) $(LDFLAGS) -o $@

all-local: evolution-addressbook.pure

evolution-addressbook.pure: evolution-addressbook
	@rm -f evolution-addressbook.pure
	$(PLINK) $(evolution_addressbook_LDFLAGS) $(evolution_addressbook_OBJECTS) $(evolution_addressbook_LDADD) $(LIBS)

endif
